<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>keta – Docs – Source: directives/date-picker.js</title>
	<meta name="description" content="jsDoc of Frontend Components for Kiwigrid Platform based AngularJS Apps">

	<link href="/keta/css/keta.min.css" rel="stylesheet">
	<link href="/keta/css/style.css" rel="stylesheet">
	<link href="/keta/css/docs.css" rel="stylesheet">
	<link href="/keta/css/prettify-tomorrow.css" rel="stylesheet">

	<!--[if lt IE 9]>
	<script src="/keta/js/html5shiv.min.js"></script>
	<script src="/keta/js/respond.min.js"></script>
	<![endif]-->
</head>
<body>
	<div class="col-xs-12 col-sm-12 col-md-3 sidebar">
		<p id="logo">
			<a href="/keta/"><img src="/keta/img/keta.svg"></a>
		</p>
		<p class="lead text-center">
			Frontend Components for Kiwigrid Platform based AngularJS Apps
		</p>
		<p class="text-center">
			Version 0.6.8
		</p>
		<p class="text-center hidden-xs hidden-sm">
			<a class="btn btn-primary" href="https://github.com/kiwigrid/keta/zipball/0.6.8" role="button">ZIP File</a>
			<a class="btn btn-primary" href="https://github.com/kiwigrid/keta/tarball/0.6.8" role="button">TAR Ball</a>
		</p>
		<p class="text-center visible-xs visible-sm">
			<a class="btn btn-lg btn-primary" href="https://github.com/kiwigrid/keta/zipball/0.6.8" role="button">ZIP File</a>
			<a class="btn btn-lg btn-primary" href="https://github.com/kiwigrid/keta/tarball/0.6.8" role="button">TAR Ball</a>
		</p>
		<ul class="nav nav-pills nav-stacked">
			<li><a href="../index.html">Home</a></li>
			<li><a href="../examples/">Examples</a></li>
			<li class="active"><a href="../docs/">Documentation</a></li>
		</ul>
		<p class="footer text-center hidden-xs hidden-sm">
			View the project on <a href="https://github.com/kiwigrid/keta">Github</a>.<br>
			Maintained by <a href="http://www.kiwigrid.com">Kiwigrid GmbH</a>.<br>
			Licensed under the <a href="https://raw.githubusercontent.com/kiwigrid/keta/master/LICENSE">MIT License</a>.
		</p>
		<p id="company" class="text-center hidden-xs hidden-sm">
			<a href="http://www.kiwigrid.com"><img src="/keta/img/kiwigrid.svg"></a>
		</p>
	</div>

	<div class="col-xs-12 col-sm-12 col-md-2 col-md-offset-3 index">
		<nav>
			<h1><a href="index.html">Index</a></h1><h3>Modules</h3><ul class="list-unstyled"><li><a href="keta.services.module_AccessToken.html">AccessToken</a></li><li><a href="keta.utils.module_Api.html">Api</a></li><li><a href="keta.directives.module_AppBar.html">AppBar</a></li><li><a href="keta.services.module_AppContext.html">AppContext</a></li><li><a href="keta.utils.module_Application.html">Application</a></li><li><a href="keta.services.module_Application.html">Application</a></li><li><a href="keta.services.module_ApplicationSet.html">ApplicationSet</a></li><li><a href="keta.utils.module_Common.html">Common</a></li><li><a href="keta.utils.module_Country.html">Country</a></li><li><a href="keta.directives.module_DatePicker.html">DatePicker</a></li><li><a href="keta.services.module_Device.html">Device</a></li><li><a href="keta.services.module_DeviceEvent.html">DeviceEvent</a></li><li><a href="keta.services.module_DeviceSet.html">DeviceSet</a></li><li><a href="keta.services.module_EventBus.html">EventBus</a></li><li><a href="keta.services.module_EventBusDispatcher.html">EventBusDispatcher</a></li><li><a href="keta.services.module_EventBusManager.html">EventBusManager</a></li><li><a href="keta.directives.module_ExtendedTable.html">ExtendedTable</a></li><li><a href="keta.services.module_Logger.html">Logger</a></li><li><a href="keta.directives.module_MainMenu.html">MainMenu</a></li><li><a href="keta.filters.module_OrderObjectBy.html">OrderObjectBy</a></li><li><a href="keta.directives.module_Sidebar.html">Sidebar</a></li><li><a href="keta.filters.module_Slice.html">Slice</a></li><li><a href="keta.services.module_Tag.html">Tag</a></li><li><a href="keta.services.module_TagSet.html">TagSet</a></li><li><a href="keta.directives.module_TimeRangeSelector.html">TimeRangeSelector</a></li><li><a href="keta.filters.module_Unit.html">Unit</a></li><li><a href="keta.services.module_User.html">User</a></li><li><a href="keta.services.module_UserSet.html">UserSet</a></li></ul>
		</nav>
	</div>

	<div class="col-xs-12 col-sm-12 col-md-7 canvas" id="#top">
		<h1 class="page-title">Source: directives/date-picker.js</h1>
		


    
    <section>
        <article>
            <pre class="prettyprint source"><code>'use strict';

/**
 * @name keta.directives.DatePicker
 * @author Marco Lehmann &lt;marco.lehmann@kiwigrid.com>
 * @copyright Kiwigrid GmbH 2014-2016
 * @module keta.directives.DatePicker
 * @description
 * &lt;p>
 *   A simple date picker component to select a single date.
 * &lt;/p>
 * @example
 * &amp;lt;div data-date-picker
 *   data-ng-model="model"
 *   data-css-classes="cssClasses"
 *   data-current-locale="currentLocale"
 *   data-display-mode="displayMode"
 *   data-display-value="displayValue"
 *   data-enable-display-mode-switch="enableDisplayModeSwitch"
 *   data-first-day-of-week="firstDayOfWeek"
 *   data-labels="labels"
 *   data-minimum="minimum"
 *   data-maximum="maximum"
 *   data-show-pager="showPager"
 *   data-show-selection-button="showSelectionButton"
 *   data-show-today-button="showTodayButton"
 *   data-show-week-numbers="showWeekNumbers"
 *   data-years-after="yearsAfter"
 *   data-years-before="yearsBefore"&amp;gt;&amp;lt;/div&amp;gt;
 * @example
 * angular.module('exampleApp', ['keta.directives.DatePicker'])
 *     .controller('ExampleController', function($scope, DatePickerConstants, DatePickerMessageKeys) {
 *
 *         // current value to use
 *         $scope.model = new Date(2016, 3, 20, 9, 0, 0, 0);
 *
 *         // css classes to use
 *         $scope.cssClasses = DatePickerConstants.CSS_CLASSES;
 *
 *         // current locale to use
 *         $scope.currentLocale = 'de_DE';
 *
 *         // display mode to use (@see DatePickerConstants.DISPLAY_MODE)
 *         $scope.displayMode = DatePickerConstants.DISPLAY_MODE.DAY;
 *
 *         // display value to use
 *         $scope.displayValue = angular.copy($scope.model);
 *
 *         // enable display mode switch
 *         $scope.enableDisplayModeSwitch = true;
 *
 *         // define first day of week
 *         $scope.firstDayOfWeek = DatePickerConstants.DAY.SUNDAY;
 *
 *         // define labels to use
 *         $scope.labels = DatePickerMessageKeys;
 *
 *         // define an optional minimum boundary
 *         $scope.minimum = moment($scope.now).subtract(30, 'days').toDate();
 *
 *         // define an optional maximum boundary
 *         $scope.maximum = moment($scope.now).add(30, 'days').toDate();
 *
 *         // show pager above
 *         $scope.showPager = true;
 *
 *         // show selection button under calendar sheet
 *         $scope.showSelectionButton = true;
 *
 *         // show today button under calendar sheet
 *         $scope.showTodayButton = true;
 *
 *         // show week number row
 *         $scope.showWeekNumbers = true;
 *
 *         // define number of years to show after current in year list
 *         $scope.yearsAfter = 4;
 *
 *         // define number of years to show before current in year list
 *         $scope.yearsBefore = 4;
 *
 *     });
 */

angular.module('keta.directives.DatePicker', [
	'moment'
])

	.constant('DatePickerConstants', {
		CSS_CLASSES: {
			CURRENT_DATE: 'current-date',
			OUT_OF_BOUNDS: 'out-of-bounds',
			OUT_OF_BOUNDS_AFTER: 'out-of-bounds-after',
			OUT_OF_BOUNDS_BEFORE: 'out-of-bounds-before',
			OUT_OF_MONTH: 'out-of-month',
			SELECTED_DATE: 'selected-date-single'
		},
		DAY: {
			SUNDAY: 0,
			MONDAY: 1,
			TUESDAY: 2,
			WEDNESDAY: 3,
			THURSDAY: 4,
			FRIDAY: 5,
			SATURDAY: 6
		},
		DISPLAY_MODE: {
			DAY: 'day',
			MONTH: 'month',
			YEAR: 'year'
		}
	})

	// message keys with default values
	.constant('DatePickerMessageKeys', {
		'en_GB': {
			'__keta.directives.DatePicker_selection': 'Selection',
			'__keta.directives.DatePicker_today': 'Today',
			'__keta.directives.DatePicker_week': 'Week',
			'__keta.directives.DatePicker_weekday_sunday': 'Sunday',
			'__keta.directives.DatePicker_weekday_sunday_short': 'Sun',
			'__keta.directives.DatePicker_weekday_monday': 'Monday',
			'__keta.directives.DatePicker_weekday_monday_short': 'Mon',
			'__keta.directives.DatePicker_weekday_tuesday': 'Tuesday',
			'__keta.directives.DatePicker_weekday_tuesday_short': 'Tue',
			'__keta.directives.DatePicker_weekday_wednesday': 'Wednesday',
			'__keta.directives.DatePicker_weekday_wednesday_short': 'Wed',
			'__keta.directives.DatePicker_weekday_thursday': 'Thursday',
			'__keta.directives.DatePicker_weekday_thursday_short': 'Thu',
			'__keta.directives.DatePicker_weekday_friday': 'Friday',
			'__keta.directives.DatePicker_weekday_friday_short': 'Fri',
			'__keta.directives.DatePicker_weekday_saturday': 'Saturday',
			'__keta.directives.DatePicker_weekday_saturday_short': 'Sat',
			'__keta.directives.DatePicker_week_number': 'Week Number',
			'__keta.directives.DatePicker_week_number_short': 'Wn'
		},
		'de_DE': {
			'__keta.directives.DatePicker_selection': 'Auswahl',
			'__keta.directives.DatePicker_today': 'Heute',
			'__keta.directives.DatePicker_week': 'Woche',
			'__keta.directives.DatePicker_weekday_sunday': 'Sonntag',
			'__keta.directives.DatePicker_weekday_sunday_short': 'So',
			'__keta.directives.DatePicker_weekday_monday': 'Montag',
			'__keta.directives.DatePicker_weekday_monday_short': 'Mo',
			'__keta.directives.DatePicker_weekday_tuesday': 'Dienstag',
			'__keta.directives.DatePicker_weekday_tuesday_short': 'Di',
			'__keta.directives.DatePicker_weekday_wednesday': 'Mittwoch',
			'__keta.directives.DatePicker_weekday_wednesday_short': 'Mi',
			'__keta.directives.DatePicker_weekday_thursday': 'Donnerstag',
			'__keta.directives.DatePicker_weekday_thursday_short': 'Do',
			'__keta.directives.DatePicker_weekday_friday': 'Freitag',
			'__keta.directives.DatePicker_weekday_friday_short': 'Fr',
			'__keta.directives.DatePicker_weekday_saturday': 'Samstag',
			'__keta.directives.DatePicker_weekday_saturday_short': 'Sa',
			'__keta.directives.DatePicker_week_number': 'Kalenderwoche',
			'__keta.directives.DatePicker_week_number_short': 'KW'
		},
		'fr_FR': {
			'__keta.directives.DatePicker_selection': 'Sélection',
			'__keta.directives.DatePicker_today': 'Aujourd’hui',
			'__keta.directives.DatePicker_week': 'Semaine',
			'__keta.directives.DatePicker_weekday_sunday': 'Dimanche',
			'__keta.directives.DatePicker_weekday_sunday_short': 'Dim',
			'__keta.directives.DatePicker_weekday_monday': 'Lundi',
			'__keta.directives.DatePicker_weekday_monday_short': 'Lun',
			'__keta.directives.DatePicker_weekday_tuesday': 'Mardi',
			'__keta.directives.DatePicker_weekday_tuesday_short': 'Mar',
			'__keta.directives.DatePicker_weekday_wednesday': 'Mercredi',
			'__keta.directives.DatePicker_weekday_wednesday_short': 'Mer',
			'__keta.directives.DatePicker_weekday_thursday': 'Jeudi',
			'__keta.directives.DatePicker_weekday_thursday_short': 'Jeu',
			'__keta.directives.DatePicker_weekday_friday': 'Vendredi',
			'__keta.directives.DatePicker_weekday_friday_short': 'Ven',
			'__keta.directives.DatePicker_weekday_saturday': 'Samedi',
			'__keta.directives.DatePicker_weekday_saturday_short': 'Sam',
			'__keta.directives.DatePicker_week_number': 'Numéro de la semaine',
			'__keta.directives.DatePicker_week_number_short': 'Sem.'
		},
		'nl_NL': {
			'__keta.directives.DatePicker_selection': 'Selectie',
			'__keta.directives.DatePicker_today': 'Vandaag',
			'__keta.directives.DatePicker_week': 'Week',
			'__keta.directives.DatePicker_weekday_sunday': 'Zondag',
			'__keta.directives.DatePicker_weekday_sunday_short': 'Zo',
			'__keta.directives.DatePicker_weekday_monday': 'Maandag',
			'__keta.directives.DatePicker_weekday_monday_short': 'Ma',
			'__keta.directives.DatePicker_weekday_tuesday': 'Dinsdag',
			'__keta.directives.DatePicker_weekday_tuesday_short': 'Di',
			'__keta.directives.DatePicker_weekday_wednesday': 'Woensdag',
			'__keta.directives.DatePicker_weekday_wednesday_short': 'Wo',
			'__keta.directives.DatePicker_weekday_thursday': 'Donderdag',
			'__keta.directives.DatePicker_weekday_thursday_short': 'Do',
			'__keta.directives.DatePicker_weekday_friday': 'Vrijdag',
			'__keta.directives.DatePicker_weekday_friday_short': 'Vr',
			'__keta.directives.DatePicker_weekday_saturday': 'Zaterdag',
			'__keta.directives.DatePicker_weekday_saturday_short': 'Za',
			'__keta.directives.DatePicker_week_number': 'Weeknummer',
			'__keta.directives.DatePicker_week_number_short': 'Wn'
		},
		'it_IT': {
			'__keta.directives.DatePicker_selection': 'Selezione',
			'__keta.directives.DatePicker_today': 'Oggi',
			'__keta.directives.DatePicker_week': 'Settimana',
			'__keta.directives.DatePicker_weekday_sunday': 'Domenica',
			'__keta.directives.DatePicker_weekday_sunday_short': 'Dom.',
			'__keta.directives.DatePicker_weekday_monday': 'Lunedì',
			'__keta.directives.DatePicker_weekday_monday_short': 'Lun.',
			'__keta.directives.DatePicker_weekday_tuesday': 'Martedì',
			'__keta.directives.DatePicker_weekday_tuesday_short': 'Mar.',
			'__keta.directives.DatePicker_weekday_wednesday': 'Mercoledì',
			'__keta.directives.DatePicker_weekday_wednesday_short': 'Mer.',
			'__keta.directives.DatePicker_weekday_thursday': 'Giovedì',
			'__keta.directives.DatePicker_weekday_thursday_short': 'Gio.',
			'__keta.directives.DatePicker_weekday_friday': 'Venerdì',
			'__keta.directives.DatePicker_weekday_friday_short': 'Ven.',
			'__keta.directives.DatePicker_weekday_saturday': 'Sabato',
			'__keta.directives.DatePicker_weekday_saturday_short': 'Sab.',
			'__keta.directives.DatePicker_week_number': 'Numero della settimana',
			'__keta.directives.DatePicker_week_number_short': 'Set.'
		}
	})

	.directive('datePicker', function DatePickerDirective(
		$filter,
		DatePickerConstants, DatePickerMessageKeys, moment
	) {
		return {
			restrict: 'EA',
			replace: true,
			require: 'ngModel',
			scope: {

				// css classes to use
				cssClasses: '=?',

				// current locale
				currentLocale: '=?',

				// display mode (@see DatePickerConstants.DISPLAY)
				displayMode: '=?',

				// display value (date)
				displayValue: '=?',

				// enable display mode switch
				enableDisplayModeSwitch: '=?',

				// first day of week (0...Sun, 1...Mon, 2...Tue, 3...Wed, 4...Thu, 5...Fri, 6...Sat)
				firstDayOfWeek: '=?',

				// object of labels to use in template
				labels: '=?',

				// maximum date selectable (date is included)
				maximum: '=?',

				// minimum date selectable (date is included)
				minimum: '=?',

				// model value (date)
				model: '=ngModel',

				// show pager above
				showPager: '=?',

				// show selection button
				showSelectionButton: '=?',

				// show today button
				showTodayButton: '=?',

				// show week numbers
				showWeekNumbers: '=?',

				// number of years to show before current in display mode year
				// must be a multiple of 3 added by 1 (e.g. 1, 4, 7, 11, ...)
				yearsAfter: '=?',

				// number of years to show after current in display mode year
				// must be a multiple of 3 added by 1 (e.g. 1, 4, 7, 11, ...)
				yearsBefore: '=?'

			},
			templateUrl: '/components/directives/date-picker.html',
			link: function(scope) {


				// CONSTANTS
				// ---------

				scope.DISPLAY_MODE_DAY = DatePickerConstants.DISPLAY_MODE.DAY;
				scope.DISPLAY_MODE_MONTH = DatePickerConstants.DISPLAY_MODE.MONTH;
				scope.DISPLAY_MODE_YEAR = DatePickerConstants.DISPLAY_MODE.YEAR;

				var DAYS_PER_WEEK = 7;
				var ISO_DATE_LENGTH_DAY = 10;
				var ISO_DATE_LENGTH_MONTH = 7;
				var ISO_DATE_LENGTH_YEAR = 4;
				var ISO_PADDING = 2;
				var LOCALE_SHORT_LENGTH = 5;
				var MONTHS_PER_ROW = 3;
				var MONTHS_PER_YEAR = 12;
				var YEARS_AFTER = 4;
				var YEARS_BEFORE = 7;
				var YEARS_PER_ROW = 3;


				// CONFIGURATION
				// -------------

				var today = new Date();
				today.setHours(0, 0, 0, 0);

				scope.model =
					angular.isDate(scope.model) ?
						new Date(scope.model.setHours(0, 0, 0, 0)) : today;
				scope.cssClasses =
					angular.isObject(scope.cssClasses) ?
						angular.extend(DatePickerConstants.CSS_CLASSES, scope.cssClasses) :
						DatePickerConstants.CSS_CLASSES;
				scope.currentLocale = angular.isString(scope.currentLocale) ? scope.currentLocale : 'en_GB';
				scope.displayMode = scope.displayMode || scope.DISPLAY_MODE_DAY;
				scope.displayValue =
					angular.isDate(scope.displayValue) ?
						new Date(scope.displayValue.setHours(0, 0, 0, 0)) : angular.copy(scope.model);
				scope.enableDisplayModeSwitch =
					angular.isDefined(scope.enableDisplayModeSwitch) ?
						scope.enableDisplayModeSwitch : true;
				scope.firstDayOfWeek = scope.firstDayOfWeek || DatePickerConstants.DAY.SUNDAY;

				// object of labels
				scope.MESSAGE_KEY_PREFIX = '__keta.directives.DatePicker';
				scope.labels =
					angular.isObject(scope.labels) ?
						angular.extend(DatePickerMessageKeys, scope.labels) : DatePickerMessageKeys;
				scope.currentLabels =
					angular.isDefined(DatePickerMessageKeys[scope.currentLocale.substr(0, LOCALE_SHORT_LENGTH)]) ?
						DatePickerMessageKeys[scope.currentLocale.substr(0, LOCALE_SHORT_LENGTH)] :
						DatePickerMessageKeys.en_GB;

				scope.maximum =
					angular.isDate(scope.maximum) ?
						new Date(scope.maximum.setHours(0, 0, 0, 0)) : null;
				scope.minimum =
					angular.isDate(scope.minimum) ?
						new Date(scope.minimum.setHours(0, 0, 0, 0)) : null;
				scope.showPager =
					angular.isDefined(scope.showPager) ?
						scope.showPager : true;
				scope.showSelectionButton =
					angular.isDefined(scope.showSelectionButton) ?
						scope.showSelectionButton : false;
				scope.showTodayButton =
					angular.isDefined(scope.showTodayButton) ?
						scope.showTodayButton : false;
				scope.showWeekNumbers =
					angular.isDefined(scope.showWeekNumbers) ?
						scope.showWeekNumbers : true;
				scope.yearsBefore = scope.yearsBefore || YEARS_BEFORE;
				scope.yearsAfter = scope.yearsAfter || YEARS_AFTER;


				// DATA
				// ----

				scope.weekDays = [];
				scope.days = [];

				scope.months = [];
				scope.years = [];


				// HELPER
				// ------

				/**
				 * get week days for currently set first day of week
				 * @returns {void} nothing
				 */
				var getWeekDays = function getWeekDays() {

					var weekDays = [];

					var weekDayLabels = [
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_sunday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_monday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_tuesday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_wednesday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_thursday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_friday_short'],
						scope.currentLabels[scope.MESSAGE_KEY_PREFIX + '_weekday_saturday_short']
					];

					var start = scope.firstDayOfWeek;
					while (weekDays.length &lt; DAYS_PER_WEEK) {
						weekDays.push(weekDayLabels[start]);
						start++;
						start %= DAYS_PER_WEEK;
					}

					scope.weekDays = weekDays;

				};

				/**
				 * get days for month in timeRange.view
				 * @returns {void} nothing
				 */
				var getDays = function getDays() {

					// get first of current and next month
					var firstOfCurrentMonth =
						moment(scope.displayValue.getTime()).startOf('month')
							.hours(0).minutes(0).seconds(0).milliseconds(0);
					var firstOfCurrentMonthWeekDay = firstOfCurrentMonth.day();

					var lastOfCurrentMonth = moment(firstOfCurrentMonth).add(1, 'months').subtract(1, 'days');
					var lastOfCurrentMonthWeekDay = lastOfCurrentMonth.day();

					var days = [];
					var i = 0;

					// PREPEND DAYS ===

					// days to prepend to first of week
					if (firstOfCurrentMonthWeekDay &lt; scope.firstDayOfWeek) {
						firstOfCurrentMonthWeekDay += DAYS_PER_WEEK;
					}
					var daysToPrepend = firstOfCurrentMonthWeekDay - scope.firstDayOfWeek;

					// prepend days
					for (i = daysToPrepend; i > 0; i--) {
						var prependedDay = moment(firstOfCurrentMonth).subtract(i, 'days');
						days.push(prependedDay.toDate());
					}

					// MONTH DAYS ===

					var monthDays = moment(lastOfCurrentMonth).date();
					for (i = 0; i &lt; monthDays; i++) {
						var monthDay = moment(firstOfCurrentMonth).add(i, 'days');
						days.push(monthDay.toDate());
					}

					// APPEND DAYS ===

					// days to append to last of week
					if (lastOfCurrentMonthWeekDay &lt; scope.firstDayOfWeek) {
						lastOfCurrentMonthWeekDay += DAYS_PER_WEEK;
					}
					var daysToAppend = DAYS_PER_WEEK - (lastOfCurrentMonthWeekDay - scope.firstDayOfWeek) - 1;

					// append days
					for (i = 1; i &lt;= daysToAppend; i++) {
						var appendedDay = moment(lastOfCurrentMonth).add(i, 'days');
						days.push(appendedDay.toDate());
					}

					// CHUNK DAYS ===

					// chunk days in weeks
					var chunks = [];
					var chunk = [];

					angular.forEach(days, function(day, index) {
						chunk.push(day);

						// add week
						if ((index + 1) % DAYS_PER_WEEK === 0) {
							chunks.push(chunk);
							chunk = [];
						}
					});

					scope.days = chunks;

				};

				/**
				 * get months
				 * @returns {void} nothing
				 */
				var getMonths = function getMonths() {

					var months = [];
					var monthsChunked = [];

					var now =
						moment(scope.displayValue)
							.date(1).hour(0).minute(0).second(0).millisecond(0)
							.toDate();

					for (var i = 0; i &lt; MONTHS_PER_YEAR; i++) {
						now.setMonth(i);
						months.push(angular.copy(now));
					}

					// chunk months in blocks of four
					var chunk = [];
					angular.forEach(months, function(month, index) {
						chunk.push(month);

						// add row
						if ((index + 1) % MONTHS_PER_ROW === 0) {
							monthsChunked.push(chunk);
							chunk = [];
						}
					});

					scope.months = monthsChunked;

				};

				/**
				 * get years around year in timeRange.view
				 * @returns {void} nothing
				 */
				var getYears = function getYears() {

					var years = [];
					var yearsChunked = [];

					var now =
						moment(scope.displayValue)
							.month(0).date(1).hour(0).minute(0).second(0).millisecond(0)
							.toDate();

					var currentYear = parseInt($filter('date')(now, 'yyyy'), 10);
					var yearStart = currentYear - scope.yearsBefore;
					var yearEnd = currentYear + scope.yearsAfter;

					for (var i = yearStart; i &lt;= yearEnd; i++) {
						now.setFullYear(i);
						years.push(angular.copy(now));
					}

					// chunk years in blocks of four
					var chunk = [];
					angular.forEach(years, function(year, index) {
						chunk.push(year);

						// add row
						if ((index + 1) % YEARS_PER_ROW === 0) {
							yearsChunked.push(chunk);
							chunk = [];
						}
					});

					scope.years = yearsChunked;

				};

				/**
				 * get locale iso date for given date and length
				 * @param {date} date date to extract iso format from
				 * @param {number} length length of iso date
				 * @returns {string} iso date
				 */
				var getLocaleISO = function getLocaleISO(date, length) {
					var iso =
						date.getFullYear() + '-' +
						('00' + (date.getMonth() + 1)).slice(-ISO_PADDING) + '-' +
						('00' + date.getDate()).slice(-ISO_PADDING);
					return iso.substr(0, length);
				};

				/**
				 * checks if given date is out of bounds
				 * @param {date} date date to get classes for
				 * @returns {boolean} true if out of bounds
				 */
				scope.isOutOfBounds = function isOutOfBounds(date) {
					var outOfBounds = false;

					var isoDateLength = ISO_DATE_LENGTH_DAY;
					if (scope.displayMode === scope.DISPLAY_MODE_MONTH) {
						isoDateLength = ISO_DATE_LENGTH_MONTH;
					}
					if (scope.displayMode === scope.DISPLAY_MODE_YEAR) {
						isoDateLength = ISO_DATE_LENGTH_YEAR;
					}

					var dateISO = getLocaleISO(date, isoDateLength);

					if (scope.minimum !== null &amp;&amp;
						dateISO &lt; getLocaleISO(scope.minimum, isoDateLength)) {
						outOfBounds = true;
					}

					if (scope.maximum !== null &amp;&amp;
						dateISO > getLocaleISO(scope.maximum, isoDateLength)) {
						outOfBounds = true;
					}

					return outOfBounds;
				};

				/**
				 * get date classes
				 * @param {date} date date to get classes for
				 * @returns {string} classes as space-separated strings
				 */
				scope.getDateClasses = function getDateClasses(date) {
					var classes = [];

					var td = new Date(new Date().setHours(0, 0, 0, 0));
					var current = scope.displayValue;

					var isoDateLength = ISO_DATE_LENGTH_DAY;
					if (scope.displayMode === scope.DISPLAY_MODE_MONTH) {
						isoDateLength = ISO_DATE_LENGTH_MONTH;
					}
					if (scope.displayMode === scope.DISPLAY_MODE_YEAR) {
						isoDateLength = ISO_DATE_LENGTH_YEAR;
					}

					var selectedDateISO = getLocaleISO(scope.model, isoDateLength);
					var dateISO = getLocaleISO(date, isoDateLength);
					var todayISO = getLocaleISO(td, isoDateLength);

					if (scope.displayMode === scope.DISPLAY_MODE_DAY &amp;&amp;
						date.getMonth() !== current.getMonth()) {
						classes.push(scope.cssClasses.OUT_OF_MONTH);
					}

					if (scope.isOutOfBounds(date)) {
						classes.push(scope.cssClasses.OUT_OF_BOUNDS);
						if (scope.minimum !== null &amp;&amp; dateISO &lt; getLocaleISO(scope.minimum, isoDateLength)) {
							classes.push(scope.cssClasses.OUT_OF_BOUNDS_BEFORE);
						}
						if (scope.maximum !== null &amp;&amp; dateISO > getLocaleISO(scope.maximum, isoDateLength)) {
							classes.push(scope.cssClasses.OUT_OF_BOUNDS_AFTER);
						}
					}

					if (dateISO === todayISO) {
						classes.push(scope.cssClasses.CURRENT_DATE);
					}

					if (selectedDateISO !== null &amp;&amp; dateISO === selectedDateISO) {
						classes.push(scope.cssClasses.SELECTED_DATE);
					}

					return classes.join(' ');
				};

				/**
				 * get year range around timeRange.view
				 * @returns {string} year range
				 */
				scope.getYearRange = function getYearRange() {
					var year = parseInt($filter('date')(scope.displayValue, 'yyyy'), 10);
					var yearStart = year - scope.yearsBefore;
					var yearEnd = year + scope.yearsAfter;
					return yearStart + ' – ' + yearEnd;
				};


				// INIT
				// ----

				/**
				 * update component data
				 * @returns {void} nothing
				 */
				var update = function update() {

					// update current labels
					scope.currentLabels =
						angular.isDefined(DatePickerMessageKeys[scope.currentLocale.substr(0, LOCALE_SHORT_LENGTH)]) ?
							DatePickerMessageKeys[scope.currentLocale.substr(0, LOCALE_SHORT_LENGTH)] :
							DatePickerMessageKeys.en_GB;

					// init week days
					getWeekDays();

					// init calendar sheet data
					if (scope.displayMode === scope.DISPLAY_MODE_MONTH) {
						getMonths();
					} else if (scope.displayMode === scope.DISPLAY_MODE_YEAR) {
						getYears();
					} else {
						getDays();
					}

				};

				update();


				// ACTIONS
				// -------

				/**
				 * move to direction based on current display
				 * @param {number} direction move offset
				 * @returns {void} nothing
				 */
				var move = function move(direction) {

					if (scope.displayMode === scope.DISPLAY_MODE_MONTH) {
						scope.displayValue = moment(scope.displayValue).add(direction, 'years').toDate();
					} else if (scope.displayMode === scope.DISPLAY_MODE_YEAR) {
						scope.displayValue = moment(scope.displayValue).add(
							direction * (scope.yearsBefore + scope.yearsAfter + 1),
							'years'
						).toDate();
					} else {
						scope.displayValue = moment(scope.displayValue).add(direction, 'months').toDate();
					}

					update();

				};

				/**
				 * move to previous based on current display
				 * @returns {void} nothing
				 */
				scope.prev = function prev() {
					move(-1);
				};

				/**
				 * move to next based on current display
				 * @returns {void} nothing
				 */
				scope.next = function next() {
					move(1);
				};

				/**
				 * select date as from or to or disable selection
				 * @param {date} date date selected
				 * @returns {void} nothing
				 */
				scope.select = function select(date) {
					if (!scope.isOutOfBounds(date)) {
						scope.model = date;
					}
				};

				/**
				 * jump to the view with the current selection in it
				 * @returns {void} nothing
				 */
				scope.goToSelection = function goToSelection() {
					scope.displayValue = angular.copy(scope.model);
				};

				/**
				 * jump to the view with the current day in it
				 * @returns {void} nothing
				 */
				scope.goToToday = function goToToday() {
					var td = new Date();
					td.setHours(0, 0, 0, 0);
					scope.displayValue = td;
				};

				/**
				 * set display mode
				 * @param {string} mode new display mode
				 * @returns {void} nothing
				 */
				scope.setDisplayMode = function setDisplayMode(mode) {
					scope.displayMode = mode;
					update();
				};

				/**
				 * set view and display after click on month or year
				 * @param {date} date date to show on calender
				 * @param {string} displayMode which display mode should be shown after click
				 * @return {void} nothing
				 */
				scope.setView = function setView(date, displayMode) {
					if (!scope.isOutOfBounds(date)) {
						scope.displayValue = angular.copy(date);
						scope.displayMode = displayMode;
					}
				};


				// WATCHER
				// -------

				// watcher for current locale
				scope.$watch('currentLocale', function(newValue, oldValue) {
					if (newValue !== oldValue &amp;&amp; angular.isString(newValue)) {
						update();
					}
				});

				// watcher for display mode
				scope.$watch('displayMode', function(newValue, oldValue) {
					if (newValue !== oldValue) {
						update();
					}
				});

				// watcher for display value
				scope.$watch('displayValue', function(newValue, oldValue) {
					if (newValue !== oldValue &amp;&amp; angular.isDate(newValue)) {
						update();
					}
				});

				// watcher for first day of week
				scope.$watch('firstDayOfWeek', function(newValue, oldValue) {
					if (newValue !== oldValue) {
						update();
					}
				});

				// watcher for years after
				scope.$watch('yearsAfter', function(newValue, oldValue) {
					if (newValue !== oldValue) {
						update();
					}
				});

				// watcher for years before
				scope.$watch('yearsBefore', function(newValue, oldValue) {
					if (newValue !== oldValue) {
						update();
					}
				});

			}
		};
	});
</code></pre>
        </article>
    </section>




	</div>

	<script src="/keta/js/prettify.js"></script>
	<script src="/keta/js/lang-css.js"></script>
	<script> prettyPrint(); </script>
	<script src="/keta/js/linenumber.js"></script>
</body>
</html>
