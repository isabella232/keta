<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>keta – Docs – Source: directives/main-menu.js</title>
	<meta name="description" content="jsDoc of Frontend Components for Kiwigrid Platform based AngularJS Apps">

	<link href="/keta/css/keta.min.css" rel="stylesheet">
	<link href="/keta/css/style.css" rel="stylesheet">
	<link href="/keta/css/docs.css" rel="stylesheet">
	<link href="/keta/css/prettify-tomorrow.css" rel="stylesheet">

	<!--[if lt IE 9]>
	<script src="/keta/js/html5shiv.min.js"></script>
	<script src="/keta/js/respond.min.js"></script>
	<![endif]-->
</head>
<body>
	<div class="col-xs-12 col-sm-12 col-md-3 sidebar">
		<p id="logo">
			<a href="/keta/"><img src="/keta/img/keta.svg"></a>
		</p>
		<p class="lead text-center">
			Frontend Components for Kiwigrid Platform based AngularJS Apps
		</p>
		<p class="text-center">
			Version 1.3.0
		</p>
		<p class="text-center hidden-xs hidden-sm">
			<a class="btn btn-primary" href="https://github.com/kiwigrid/keta/zipball/1.3.0" role="button">ZIP File</a>
			<a class="btn btn-primary" href="https://github.com/kiwigrid/keta/tarball/1.3.0" role="button">TAR Ball</a>
		</p>
		<p class="text-center visible-xs visible-sm">
			<a class="btn btn-lg btn-primary" href="https://github.com/kiwigrid/keta/zipball/1.3.0" role="button">ZIP File</a>
			<a class="btn btn-lg btn-primary" href="https://github.com/kiwigrid/keta/tarball/1.3.0" role="button">TAR Ball</a>
		</p>
		<ul class="nav nav-pills nav-stacked">
			<li><a href="../index.html">Home</a></li>
			<li><a href="../examples/">Examples</a></li>
			<li class="active"><a href="../docs/">Documentation</a></li>
		</ul>
		<p class="footer text-center hidden-xs hidden-sm">
			View the project on <a href="https://github.com/kiwigrid/keta">Github</a>.<br>
			Maintained by <a href="http://www.kiwigrid.com">Kiwigrid GmbH</a>.<br>
			Licensed under the <a href="https://raw.githubusercontent.com/kiwigrid/keta/master/LICENSE">MIT License</a>.
		</p>
		<p id="company" class="text-center hidden-xs hidden-sm">
			<a href="http://www.kiwigrid.com"><img src="/keta/img/kiwigrid.svg"></a>
		</p>
	</div>

	<div class="col-xs-12 col-sm-12 col-md-2 col-md-offset-3 index">
		<nav>
			<h1><a href="index.html">Index</a></h1><h3>Modules</h3><ul class="list-unstyled"><li><a href="keta.services.module_AccessToken.html">AccessToken</a></li><li><a href="keta.utils.module_Api.html">Api</a></li><li><a href="keta.directives.module_AppBar.html">AppBar</a></li><li><a href="keta.services.module_AppContext.html">AppContext</a></li><li><a href="keta.utils.module_Application.html">Application</a></li><li><a href="keta.services.module_Application.html">Application</a></li><li><a href="keta.services.module_ApplicationSet.html">ApplicationSet</a></li><li><a href="keta.utils.module_Common.html">Common</a></li><li><a href="keta.utils.module_Country.html">Country</a></li><li><a href="keta.directives.module_DatePicker.html">DatePicker</a></li><li><a href="keta.services.module_Device.html">Device</a></li><li><a href="keta.services.module_DeviceEvent.html">DeviceEvent</a></li><li><a href="keta.services.module_DeviceSet.html">DeviceSet</a></li><li><a href="keta.services.module_EventBus.html">EventBus</a></li><li><a href="keta.services.module_EventBusDispatcher.html">EventBusDispatcher</a></li><li><a href="keta.services.module_EventBusManager.html">EventBusManager</a></li><li><a href="keta.directives.module_ExtendedTable.html">ExtendedTable</a></li><li><a href="keta.services.module_Logger.html">Logger</a></li><li><a href="keta.directives.module_MainMenu.html">MainMenu</a></li><li><a href="keta.filters.module_OrderObjectBy.html">OrderObjectBy</a></li><li><a href="keta.directives.module_Sidebar.html">Sidebar</a></li><li><a href="keta.filters.module_Slice.html">Slice</a></li><li><a href="keta.services.module_Tag.html">Tag</a></li><li><a href="keta.services.module_TagSet.html">TagSet</a></li><li><a href="keta.directives.module_TimeRangeSelector.html">TimeRangeSelector</a></li><li><a href="keta.filters.module_Unit.html">Unit</a></li><li><a href="keta.services.module_User.html">User</a></li><li><a href="keta.services.module_UserSet.html">UserSet</a></li></ul>
		</nav>
	</div>

	<div class="col-xs-12 col-sm-12 col-md-7 canvas" id="#top">
		<h1 class="page-title">Source: directives/main-menu.js</h1>
		


    
    <section>
        <article>
            <pre class="prettyprint source"><code>'use strict';

/**
 * @name keta.directives.MainMenu
 * @author Jan Uhlmann &lt;jan.uhlmann@kiwigrid.com>
 * @copyright Kiwigrid GmbH 2014-2015
 * @module keta.directives.MainMenu
 * @description
 * &lt;p>
 *   Main menu with marking of currently active menu-entry. The menu can be nested (maximum 3 levels) with automatic
 *   expand/fold functionality.
 * &lt;/p>
 * &lt;p>
 *   The optional property toggleBroadcast is used to execute events from the $rootScope. For example
 *   if the menu is inside an opened sidebar the event is used to close
 *   the sidebar (if the current path-route is the same as in the clicked link).
 * &lt;/p>
 * @example
 * &amp;lt;div data-keta-main-menu data-configuration="menuConfiguration" data-title-callback="getAppTitle"&amp;gt;&amp;lt;/div&amp;gt;
 * @example
 * angular.module('exampleApp', ['keta.directives.MainMenu', 'keta.directives.Sidebar'])
 *     .controller('ExampleController', function($scope, ketaSidebarConfig) {
 *
 *         // menu object to use as input for directive
 *         $scope.menuConfiguration = {
 *             items: [{
 *                 name: 'Dashboard',
 *                 link: '/dashboard',
 *                 icon: 'signal'
 *             }, {
 *                 name: 'Applications',
 *                 icon: 'th-large',
 *                 items: [{
 *                     name: 'Application 1',
 *                     link: '/applications/1'
 *                 }, {
 *                     name: 'All Apps',
 *                     items: [{
 *                         name: 'Application 2',
 *                         link: '/applications/2'
 *                     }, {
 *                         name: 'Application 3',
 *                         link: '/applications/3'
 *                     }]
 *                 }]
 *             }],
 *             compactMode: false,
 *             toggleBroadcast: ketaSidebarConfig.EVENT.TOGGLE_SIDEBAR_LEFT
 *         };
 *
 *         // return app-title depending on current language
 *         $scope.getAppTitle = function() {
 *             return 'My App';
 *         };
 *
 *     });
 */

angular.module('keta.directives.MainMenu', [])
	.directive('ketaMainMenu', function MainMenuDirective($location, $rootScope) {
		return {
			restrict: 'EA',
			replace: true,
			scope: {
				configuration: '=',
				titleCallback: '=?'
			},
			templateUrl: '/components/directives/main-menu.html',
			link: function(scope) {

				scope.titleCallback = scope.titleCallback || function() {
					return '';
				};

				var checkPaths = function checkPaths(currentMenuLevelParts, locationLevelParts, activeFlag) {
					for (var i = 1; i &lt; currentMenuLevelParts.length; i++) {
						if (currentMenuLevelParts[i] !== locationLevelParts[i]) {
							activeFlag = false;
						}
					}
					return activeFlag;
				};

				scope.isActive = function(menuEntry) {
					var currentMenuLevelParts = menuEntry.link.split('/');
					var locationLevelParts = $location.path().split('/');
					var isActive = true;

					// Menu-entries with sub-entries have another active-class
					// to visualize the breadcrumb-path (in normal menu mode, see function isActiveParent)
					if (angular.isArray(menuEntry.items) &amp;&amp; menuEntry.items.length > 0) {
						return false;
					}

					isActive = checkPaths(currentMenuLevelParts, locationLevelParts, isActive);
					return isActive;
				};

				scope.isActiveParent = function(menuEntry) {
					var currentMenuLevelParts = menuEntry.link.split('/');
					var locationLevelParts = $location.path().split('/');
					var isActiveParent = false;

					if (angular.isArray(menuEntry.items) &amp;&amp; menuEntry.items.length > 0) {
						isActiveParent = true;
						isActiveParent = checkPaths(currentMenuLevelParts, locationLevelParts, isActiveParent);
					}
					return isActiveParent;
				};

				scope.checkExpand = function(menuEntry, $event) {

					var menuLink = menuEntry.link;

					// strip '#' at beginning if present
					if (angular.isString(menuLink) &amp;&amp;
						menuLink.substr(0, 1) === '#') {
						menuLink = angular.copy(menuLink.substr(1, menuLink.length - 1));
					}

					// close sidebar when route links of current route and menu entry are equal
					if ($location.url() === menuLink &amp;&amp;
						angular.isDefined(scope.configuration.toggleBroadcast)) {
						$event.stopPropagation();
						$rootScope.$broadcast(scope.configuration.toggleBroadcast);
					}

					if (angular.isArray(menuEntry.items) &amp;&amp; menuEntry.items.length > 0) {
						// prevent route-redirect when clicking an expand-menu-entry
						$event.preventDefault();
						if (angular.isUndefined(menuEntry.expanded) || menuEntry.expanded === false) {
							menuEntry.expanded = true;
						} else {
							menuEntry.expanded = !menuEntry.expanded;
						}
					}

				};

			}
		};
	});
</code></pre>
        </article>
    </section>




	</div>

	<script src="/keta/js/prettify.js"></script>
	<script src="/keta/js/lang-css.js"></script>
	<script> prettyPrint(); </script>
	<script src="/keta/js/linenumber.js"></script>
</body>
</html>
