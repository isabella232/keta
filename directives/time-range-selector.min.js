/**
 * keta 0.6.5
 * Build 2016-09-16T09:18:38.925Z
 *
 * Copyright Kiwigrid GmbH 2014-2016
 * http://kiwigrid.github.io/keta/
 *
 * Licensed under MIT License
 * https://raw.githubusercontent.com/kiwigrid/keta/master/LICENSE
 */
"use strict";angular.module("keta.directives.TimeRangeSelector",["moment"]).constant("TimeRangeSelectorConstants",{CSS_CLASSES:{CURRENT_DATE:"current-date",OUT_OF_BOUNDS:"out-of-bounds",OUT_OF_BOUNDS_AFTER:"out-of-bounds-after",OUT_OF_BOUNDS_BEFORE:"out-of-bounds-before",OUT_OF_MONTH:"out-of-month",SELECTED_DATE:"selected-date",SELECTED_DATE_FROM:"selected-date-from",SELECTED_DATE_TO:"selected-date-to"},DAY:{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},DISPLAY_MODE:{DAY:"day",MONTH:"month",YEAR:"year"}}).constant("TimeRangeSelectorMessageKeys",{en_GB:{"__keta.directives.TimeRangeSelector_display_mode_days":"Days","__keta.directives.TimeRangeSelector_display_mode_months":"Months","__keta.directives.TimeRangeSelector_display_mode_years":"Years","__keta.directives.TimeRangeSelector_selection":"Selection","__keta.directives.TimeRangeSelector_today":"Today","__keta.directives.TimeRangeSelector_week":"Week","__keta.directives.TimeRangeSelector_weekday_sunday":"Sunday","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Sun","__keta.directives.TimeRangeSelector_weekday_monday":"Monday","__keta.directives.TimeRangeSelector_weekday_monday_short":"Mon","__keta.directives.TimeRangeSelector_weekday_tuesday":"Tuesday","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Tue","__keta.directives.TimeRangeSelector_weekday_wednesday":"Wednesday","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Wed","__keta.directives.TimeRangeSelector_weekday_thursday":"Thursday","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Thu","__keta.directives.TimeRangeSelector_weekday_friday":"Friday","__keta.directives.TimeRangeSelector_weekday_friday_short":"Fri","__keta.directives.TimeRangeSelector_weekday_saturday":"Saturday","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sat","__keta.directives.TimeRangeSelector_week_number":"Week Number","__keta.directives.TimeRangeSelector_week_number_short":"Wn"},de_DE:{"__keta.directives.TimeRangeSelector_display_mode_days":"Tage","__keta.directives.TimeRangeSelector_display_mode_months":"Monate","__keta.directives.TimeRangeSelector_display_mode_years":"Jahre","__keta.directives.TimeRangeSelector_selection":"Auswahl","__keta.directives.TimeRangeSelector_today":"Heute","__keta.directives.TimeRangeSelector_week":"Woche","__keta.directives.TimeRangeSelector_weekday_sunday":"Sonntag","__keta.directives.TimeRangeSelector_weekday_sunday_short":"So","__keta.directives.TimeRangeSelector_weekday_monday":"Montag","__keta.directives.TimeRangeSelector_weekday_monday_short":"Mo","__keta.directives.TimeRangeSelector_weekday_tuesday":"Dienstag","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Di","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mittwoch","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mi","__keta.directives.TimeRangeSelector_weekday_thursday":"Donnerstag","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Do","__keta.directives.TimeRangeSelector_weekday_friday":"Freitag","__keta.directives.TimeRangeSelector_weekday_friday_short":"Fr","__keta.directives.TimeRangeSelector_weekday_saturday":"Samstag","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sa","__keta.directives.TimeRangeSelector_week_number":"Kalenderwoche","__keta.directives.TimeRangeSelector_week_number_short":"KW"},fr_FR:{"__keta.directives.TimeRangeSelector_display_mode_days":"Journées","__keta.directives.TimeRangeSelector_display_mode_months":"Mois","__keta.directives.TimeRangeSelector_display_mode_years":"Années","__keta.directives.TimeRangeSelector_selection":"Sélection","__keta.directives.TimeRangeSelector_today":"Aujourd’hui","__keta.directives.TimeRangeSelector_week":"Semaine","__keta.directives.TimeRangeSelector_weekday_sunday":"Dimanche","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Dim","__keta.directives.TimeRangeSelector_weekday_monday":"Lundi","__keta.directives.TimeRangeSelector_weekday_monday_short":"Lun","__keta.directives.TimeRangeSelector_weekday_tuesday":"Mardi","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Mar","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mercredi","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mer","__keta.directives.TimeRangeSelector_weekday_thursday":"Jeudi","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Jeu","__keta.directives.TimeRangeSelector_weekday_friday":"Vendredi","__keta.directives.TimeRangeSelector_weekday_friday_short":"Ven","__keta.directives.TimeRangeSelector_weekday_saturday":"Samedi","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sam","__keta.directives.TimeRangeSelector_week_number":"Numéro de la semaine","__keta.directives.TimeRangeSelector_week_number_short":"Sem."},nl_NL:{"__keta.directives.TimeRangeSelector_display_mode_days":"Dagen","__keta.directives.TimeRangeSelector_display_mode_months":"Maanden","__keta.directives.TimeRangeSelector_display_mode_years":"Jaren","__keta.directives.TimeRangeSelector_selection":"Selectie","__keta.directives.TimeRangeSelector_today":"Vandaag","__keta.directives.TimeRangeSelector_week":"Week","__keta.directives.TimeRangeSelector_weekday_sunday":"Zondag","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Zo","__keta.directives.TimeRangeSelector_weekday_monday":"Maandag","__keta.directives.TimeRangeSelector_weekday_monday_short":"Ma","__keta.directives.TimeRangeSelector_weekday_tuesday":"Dinsdag","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Di","__keta.directives.TimeRangeSelector_weekday_wednesday":"Woensdag","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Wo","__keta.directives.TimeRangeSelector_weekday_thursday":"Donderdag","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Do","__keta.directives.TimeRangeSelector_weekday_friday":"Vrijdag","__keta.directives.TimeRangeSelector_weekday_friday_short":"Vr","__keta.directives.TimeRangeSelector_weekday_saturday":"Zaterdag","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Za","__keta.directives.TimeRangeSelector_week_number":"Weeknummer","__keta.directives.TimeRangeSelector_week_number_short":"Wn"},it_IT:{"__keta.directives.TimeRangeSelector_display_mode_days":"Giorni","__keta.directives.TimeRangeSelector_display_mode_months":"Mesi","__keta.directives.TimeRangeSelector_display_mode_years":"Anni","__keta.directives.TimeRangeSelector_selection":"Selezione","__keta.directives.TimeRangeSelector_today":"Oggi","__keta.directives.TimeRangeSelector_week":"Settimana","__keta.directives.TimeRangeSelector_weekday_sunday":"Domenica","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Dom.","__keta.directives.TimeRangeSelector_weekday_monday":"Lunedì","__keta.directives.TimeRangeSelector_weekday_monday_short":"Lun.","__keta.directives.TimeRangeSelector_weekday_tuesday":"Martedì","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Mar.","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mercoledì","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mer.","__keta.directives.TimeRangeSelector_weekday_thursday":"Giovedì","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Gio.","__keta.directives.TimeRangeSelector_weekday_friday":"Venerdì","__keta.directives.TimeRangeSelector_weekday_friday_short":"Ven.","__keta.directives.TimeRangeSelector_weekday_saturday":"Sabato","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sab.","__keta.directives.TimeRangeSelector_week_number":"Numero della settimana","__keta.directives.TimeRangeSelector_week_number_short":"Set."}}).directive("timeRangeSelector",function($filter,TimeRangeSelectorConstants,TimeRangeSelectorMessageKeys,moment){return{restrict:"EA",replace:!0,require:"ngModel",scope:{cssClasses:"=?",currentLocale:"=?",displayMode:"=?",displayValue:"=?",enableDisplayModeSwitch:"=?",enableWeekSelection:"=?",firstDayOfWeek:"=?",labels:"=?",maximum:"=?",maxRangeLength:"=?",minimum:"=?",minRangeLength:"=?",model:"=ngModel",showDisplayModeSwitcher:"=?",showPager:"=?",showSelectionButton:"=?",showTodayButton:"=?",showWeekNumbers:"=?",yearsAfter:"=?",yearsBefore:"=?"},templateUrl:"/components/directives/time-range-selector.html",link:function(scope){scope.DISPLAY_MODE_DAY=TimeRangeSelectorConstants.DISPLAY_MODE.DAY,scope.DISPLAY_MODE_MONTH=TimeRangeSelectorConstants.DISPLAY_MODE.MONTH,scope.DISPLAY_MODE_YEAR=TimeRangeSelectorConstants.DISPLAY_MODE.YEAR;var DAYS_PER_WEEK=7,ISO_DATE_LENGTH_DAY=10,ISO_DATE_LENGTH_MONTH=7,ISO_DATE_LENGTH_YEAR=4,ISO_PADDING=2,LAST_SELECTED_FROM="from",LAST_SELECTED_TO="to",LOCALE_SHORT_LENGTH=5,MONTHS_PER_ROW=3,MONTHS_PER_YEAR=12,YEARS_AFTER=4,YEARS_BEFORE=7,YEARS_PER_ROW=3,today=new Date;today.setHours(0,0,0,0);var defaultModel={from:null,to:null};scope.model=angular.isDefined(scope.model.from)&&angular.isDate(scope.model.from)&&angular.isDefined(scope.model.to)&&angular.isDate(scope.model.to)?scope.model:defaultModel,null!==scope.model.from&&scope.model.from.setHours(0,0,0,0),null!==scope.model.to&&scope.model.to.setHours(0,0,0,0),scope.cssClasses=angular.isObject(scope.cssClasses)?angular.extend(TimeRangeSelectorConstants.CSS_CLASSES,scope.cssClasses):TimeRangeSelectorConstants.CSS_CLASSES,scope.currentLocale=angular.isString(scope.currentLocale)?scope.currentLocale:"en_GB",scope.displayMode=scope.displayMode||scope.DISPLAY_MODE_DAY,scope.displayValue=angular.isDate(scope.displayValue)?new Date(scope.displayValue.setHours(0,0,0,0)):angular.copy(scope.model.from),null===scope.displayValue&&(scope.displayValue=today),scope.enableDisplayModeSwitch=angular.isDefined(scope.enableDisplayModeSwitch)?scope.enableDisplayModeSwitch:!1,scope.enableWeekSelection=angular.isDefined(scope.enableWeekSelection)?scope.enableWeekSelection:!1,scope.firstDayOfWeek=scope.firstDayOfWeek||TimeRangeSelectorConstants.DAY.SUNDAY,scope.MESSAGE_KEY_PREFIX="__keta.directives.TimeRangeSelector",scope.labels=angular.isObject(scope.labels)?angular.extend(TimeRangeSelectorMessageKeys,scope.labels):TimeRangeSelectorMessageKeys,scope.currentLabels=angular.isDefined(TimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,LOCALE_SHORT_LENGTH)])?TimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,LOCALE_SHORT_LENGTH)]:TimeRangeSelectorMessageKeys.en_GB,scope.maximum=angular.isDate(scope.maximum)?new Date(scope.maximum.setHours(0,0,0,0)):null,scope.maxRangeLength=angular.isNumber(scope.maxRangeLength)?Math.max(0,Math.round(scope.maxRangeLength)):0,scope.minimum=angular.isDate(scope.minimum)?new Date(scope.minimum.setHours(0,0,0,0)):null,scope.minRangeLength=angular.isNumber(scope.minRangeLength)?Math.max(0,Math.round(scope.minRangeLength)):0,scope.showDisplayModeSwitcher=angular.isDefined(scope.showDisplayModeSwitcher)?scope.showDisplayModeSwitcher:!0,scope.showPager=angular.isDefined(scope.showPager)?scope.showPager:!0,scope.showSelectionButton=angular.isDefined(scope.showSelectionButton)?scope.showSelectionButton:!0,scope.showTodayButton=angular.isDefined(scope.showTodayButton)?scope.showTodayButton:!0,scope.showWeekNumbers=angular.isDefined(scope.showWeekNumbers)?scope.showWeekNumbers:!0,scope.yearsBefore=scope.yearsBefore||YEARS_BEFORE,scope.yearsAfter=scope.yearsAfter||YEARS_AFTER,scope.weekDays=[],scope.days=[],scope.months=[],scope.years=[];var getWeekDays=function(){for(var weekDays=[],weekDayLabels=[scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_sunday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_monday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_tuesday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_wednesday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_thursday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_friday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_saturday_short"]],start=scope.firstDayOfWeek;weekDays.length<DAYS_PER_WEEK;)weekDays.push(weekDayLabels[start]),start++,start%=DAYS_PER_WEEK;scope.weekDays=weekDays},getDays=function(){var firstOfCurrentMonth=moment(scope.displayValue.getTime()).startOf("month").hours(0).minutes(0).seconds(0).milliseconds(0),firstOfCurrentMonthWeekDay=firstOfCurrentMonth.day(),lastOfCurrentMonth=moment(firstOfCurrentMonth).add(1,"months").subtract(1,"days"),lastOfCurrentMonthWeekDay=lastOfCurrentMonth.day(),days=[],i=0;firstOfCurrentMonthWeekDay<scope.firstDayOfWeek&&(firstOfCurrentMonthWeekDay+=DAYS_PER_WEEK);var daysToPrepend=firstOfCurrentMonthWeekDay-scope.firstDayOfWeek;for(i=daysToPrepend;i>0;i--){var prependedDay=moment(firstOfCurrentMonth).subtract(i,"days");days.push(prependedDay.toDate())}var monthDays=moment(lastOfCurrentMonth).date();for(i=0;monthDays>i;i++){var monthDay=moment(firstOfCurrentMonth).add(i,"days");days.push(monthDay.toDate())}lastOfCurrentMonthWeekDay<scope.firstDayOfWeek&&(lastOfCurrentMonthWeekDay+=DAYS_PER_WEEK);var daysToAppend=DAYS_PER_WEEK-(lastOfCurrentMonthWeekDay-scope.firstDayOfWeek)-1;for(i=1;daysToAppend>=i;i++){var appendedDay=moment(lastOfCurrentMonth).add(i,"days");days.push(appendedDay.toDate())}var chunks=[],chunk=[];angular.forEach(days,function(day,index){chunk.push(day),(index+1)%DAYS_PER_WEEK===0&&(chunks.push(chunk),chunk=[])}),scope.days=chunks},getMonths=function(){for(var months=[],monthsChunked=[],now=moment(scope.displayValue).date(1).hour(0).minute(0).second(0).millisecond(0).toDate(),i=0;MONTHS_PER_YEAR>i;i++)now.setMonth(i),months.push(angular.copy(now));var chunk=[];angular.forEach(months,function(month,index){chunk.push(month),(index+1)%MONTHS_PER_ROW===0&&(monthsChunked.push(chunk),chunk=[])}),scope.months=monthsChunked},getYears=function(){var years=[],yearsChunked=[],now=moment(new Date).month(0).date(1).hour(0).minute(0).second(0).millisecond(0).toDate(),currentYear=parseInt($filter("date")(now,"yyyy"),10),yearStart=currentYear-scope.yearsBefore,yearEnd=currentYear+scope.yearsAfter,viewYear=parseInt($filter("date")(scope.displayValue,"yyyy"),10),range=scope.yearsBefore+scope.yearsAfter+1;if(yearStart>viewYear)for(;yearStart>viewYear;)yearStart-=range,yearEnd-=range;if(viewYear>yearEnd)for(;viewYear>yearEnd;)yearStart+=range,yearEnd+=range;for(var i=yearStart;yearEnd>=i;i++)now.setFullYear(i),years.push(angular.copy(now));var chunk=[];angular.forEach(years,function(year,index){chunk.push(year),(index+1)%YEARS_PER_ROW===0&&(yearsChunked.push(chunk),chunk=[])}),scope.years=yearsChunked},getLocaleISO=function(date,length){var iso=date.getFullYear()+"-"+("00"+(date.getMonth()+1)).slice(-ISO_PADDING)+"-"+("00"+date.getDate()).slice(-ISO_PADDING);return iso.substr(0,length)};scope.isOutOfBounds=function(date){var outOfBounds=!1,dateISO=getLocaleISO(date,ISO_DATE_LENGTH_DAY);return null!==scope.minimum&&dateISO<getLocaleISO(scope.minimum,ISO_DATE_LENGTH_DAY)&&(outOfBounds=!0),null!==scope.maximum&&dateISO>getLocaleISO(scope.maximum,ISO_DATE_LENGTH_DAY)&&(outOfBounds=!0),outOfBounds},scope.getDateClasses=function(date){var classes=[],td=new Date((new Date).setHours(0,0,0,0)),current=scope.displayValue,isoDateLength=ISO_DATE_LENGTH_DAY,outOfBoundDates=[getLocaleISO(date,ISO_DATE_LENGTH_DAY),getLocaleISO(date,ISO_DATE_LENGTH_DAY)];scope.displayMode===scope.DISPLAY_MODE_MONTH&&(isoDateLength=ISO_DATE_LENGTH_MONTH,outOfBoundDates=[getLocaleISO(moment(date).clone().startOf("month").toDate(),ISO_DATE_LENGTH_DAY),getLocaleISO(moment(date).clone().endOf("month").toDate(),ISO_DATE_LENGTH_DAY)]),scope.displayMode===scope.DISPLAY_MODE_YEAR&&(isoDateLength=ISO_DATE_LENGTH_YEAR,outOfBoundDates=[getLocaleISO(moment(date).clone().startOf("year").toDate(),ISO_DATE_LENGTH_DAY),getLocaleISO(moment(date).clone().endOf("year").toDate(),ISO_DATE_LENGTH_DAY)]);var selectedDateFromISO=null!==scope.model.from?getLocaleISO(scope.model.from,isoDateLength):null,selectedDateToISO=null!==scope.model.to?getLocaleISO(scope.model.to,isoDateLength):null,dateISO=getLocaleISO(date,isoDateLength),todayISO=getLocaleISO(td,isoDateLength);if(scope.displayMode===scope.DISPLAY_MODE_DAY&&date.getMonth()!==current.getMonth()&&classes.push(scope.cssClasses.OUT_OF_MONTH),null!==scope.minimum){var minimumISO=getLocaleISO(scope.minimum,ISO_DATE_LENGTH_DAY);outOfBoundDates[0]<minimumISO&&outOfBoundDates[1]<minimumISO&&(classes.push(scope.cssClasses.OUT_OF_BOUNDS),classes.push(scope.cssClasses.OUT_OF_BOUNDS_BEFORE))}if(null!==scope.maximum){var maximumISO=getLocaleISO(scope.maximum,ISO_DATE_LENGTH_DAY);outOfBoundDates[0]>maximumISO&&outOfBoundDates[1]>maximumISO&&(classes.push(scope.cssClasses.OUT_OF_BOUNDS),classes.push(scope.cssClasses.OUT_OF_BOUNDS_AFTER))}return dateISO===todayISO&&classes.push(scope.cssClasses.CURRENT_DATE),null!==selectedDateFromISO&&null!==selectedDateToISO&&dateISO>=selectedDateFromISO&&selectedDateToISO>=dateISO&&classes.push(scope.cssClasses.SELECTED_DATE),null!==selectedDateFromISO&&dateISO===selectedDateFromISO&&classes.push(scope.cssClasses.SELECTED_DATE_FROM),null!==selectedDateToISO&&dateISO===selectedDateToISO&&classes.push(scope.cssClasses.SELECTED_DATE_TO),classes.join(" ")},scope.getYearRange=function(){var year=parseInt($filter("date")(scope.displayValue,"yyyy"),10),yearStart=year-scope.yearsBefore,yearEnd=year+scope.yearsAfter;return yearStart+" – "+yearEnd};var update=function(){scope.currentLabels=angular.isDefined(TimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,LOCALE_SHORT_LENGTH)])?TimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,LOCALE_SHORT_LENGTH)]:TimeRangeSelectorMessageKeys.en_GB,getWeekDays(),scope.displayMode===scope.DISPLAY_MODE_MONTH?getMonths():scope.displayMode===scope.DISPLAY_MODE_YEAR?getYears():getDays()};update();var move=function(direction){scope.displayMode===scope.DISPLAY_MODE_MONTH?scope.displayValue=moment(scope.displayValue).add(direction,"years").toDate():scope.displayMode===scope.DISPLAY_MODE_YEAR?scope.displayValue=moment(scope.displayValue).add(direction*(scope.yearsBefore+scope.yearsAfter+1),"years").toDate():scope.displayValue=moment(scope.displayValue).add(direction,"months").toDate(),update()};scope.prev=function(){move(-1)},scope.next=function(){move(1)};var lastSelected=LAST_SELECTED_FROM,getDisplayModeDate=function(date,mode,from){var displayModeDate=null;return displayModeDate=mode===TimeRangeSelectorConstants.DISPLAY_MODE.MONTH?from?date:moment(date).endOf("month").hour(0).minute(0).second(0).millisecond(0).toDate():mode===TimeRangeSelectorConstants.DISPLAY_MODE.YEAR?from?date:moment(date).endOf("year").hour(0).minute(0).second(0).millisecond(0).toDate():angular.copy(date)},applyRangeLength=function(from,to,min,max){var range={from:from,to:to},days=moment(to).diff(moment(from),"days");return 0!==max&&days>=max&&(lastSelected===LAST_SELECTED_FROM?range.to=moment(from).add(max-1,"days").toDate():range.from=moment(to).subtract(max-1,"days").toDate()),0!==min&&min>=days&&(lastSelected===LAST_SELECTED_FROM?range.to=moment(from).add(min-1,"days").toDate():range.from=moment(to).subtract(min-1,"days").toDate()),range},applyBoundaries=function(from,to,min,max){var range={from:from,to:to};return null!==min&&range.from<min&&(range.from=min),null!==max&&range.to>max&&(range.to=max),range};scope.select=function(date){null!==scope.minimum&&date.getTime()<scope.minimum&&(date=new Date(scope.minimum)),null!==scope.maximum&&date.getTime()>scope.maximum&&(date=new Date(scope.maximum)),null===scope.model.from&&null===scope.model.to?(scope.model.from=getDisplayModeDate(date,scope.displayMode,!0),scope.model.to=getDisplayModeDate(date,scope.displayMode,!1),lastSelected=LAST_SELECTED_FROM):angular.equals(scope.model.from,date)?(scope.model.to=getDisplayModeDate(scope.model.from,scope.displayMode,!1),lastSelected=LAST_SELECTED_TO):angular.equals(scope.model.to,date)?(scope.model.from=getDisplayModeDate(scope.model.to,scope.displayMode,!0),lastSelected=LAST_SELECTED_FROM):date.getTime()<scope.model.from.getTime()?(scope.model.from=getDisplayModeDate(date,scope.displayMode,!0),lastSelected=LAST_SELECTED_FROM):date.getTime()>scope.model.to.getTime()?(scope.model.to=getDisplayModeDate(date,scope.displayMode,!1),lastSelected=LAST_SELECTED_TO):lastSelected===LAST_SELECTED_FROM?(scope.model.to=getDisplayModeDate(date,scope.displayMode,!1),lastSelected=LAST_SELECTED_TO):(scope.model.from=getDisplayModeDate(date,scope.displayMode,!0),lastSelected=LAST_SELECTED_FROM),scope.model=applyRangeLength(scope.model.from,scope.model.to,scope.minRangeLength,scope.maxRangeLength),scope.model=applyBoundaries(scope.model.from,scope.model.to,scope.minimum,scope.maximum),scope.displayValue=lastSelected===LAST_SELECTED_FROM?angular.copy(scope.model.from):angular.copy(scope.model.to)},scope.selectWeek=function(date){var firstOfWeek=moment(date).hour(0).minute(0).second(0).millisecond(0).toDate(),lastOfWeek=moment(firstOfWeek).add(DAYS_PER_WEEK-1,"days").hour(0).minute(0).second(0).millisecond(0).toDate();!scope.isOutOfBounds(firstOfWeek)&&!scope.isOutOfBounds(lastOfWeek)&&(0===scope.minRangeLength||scope.minRangeLength<=DAYS_PER_WEEK)&&(0===scope.maxRangeLength||scope.maxRangeLength>=DAYS_PER_WEEK)&&scope.enableWeekSelection&&(scope.model.from=getDisplayModeDate(firstOfWeek,scope.displayMode,!0),scope.model.to=getDisplayModeDate(lastOfWeek,scope.displayMode,!1))},scope.goToSelection=function(){null!==scope.model.from&&(scope.displayValue=lastSelected===LAST_SELECTED_FROM?angular.copy(scope.model.from):angular.copy(scope.model.to))},scope.goToToday=function(){var td=new Date;td.setHours(0,0,0,0),scope.displayValue=td},scope.setDisplayMode=function(mode){scope.displayMode=mode,update()},scope.setView=function(date,displayMode){scope.displayValue=angular.copy(date),scope.displayMode=displayMode},scope.$watch("currentLocale",function(newValue,oldValue){newValue!==oldValue&&angular.isString(newValue)&&update()}),scope.$watch("displayMode",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("displayValue",function(newValue,oldValue){newValue!==oldValue&&angular.isDate(newValue)&&update()}),scope.$watch("firstDayOfWeek",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("maxRangeLength",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyRangeLength(scope.model.from,scope.model.to,scope.minRangeLength,newValue))}),scope.$watch("minRangeLength",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyRangeLength(scope.model.from,scope.model.to,newValue,scope.maxRangeLength))}),scope.$watch("maximum",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyBoundaries(scope.model.from,scope.model.to,scope.mininum,newValue))}),scope.$watch("minimum",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyBoundaries(scope.model.from,scope.model.to,newValue,scope.maximum))}),scope.$watch("yearsAfter",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("yearsBefore",function(newValue,oldValue){newValue!==oldValue&&update()})}}}),angular.module("keta.directives.TimeRangeSelector").run(function($templateCache){$templateCache.put("/components/directives/time-range-selector.html",'<div class="keta-time-range-selector">	<!-- view mode -->	<p class="text-center display-mode-switcher" data-ng-if="showDisplayModeSwitcher">		<strong data-ng-if="displayMode === DISPLAY_MODE_DAY">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_days\'] }}</strong>		<a href="" data-ng-if="displayMode !== DISPLAY_MODE_DAY"			data-ng-click="setView(displayValue, DISPLAY_MODE_DAY)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_days\'] }}</a> |		<strong data-ng-if="displayMode === DISPLAY_MODE_MONTH">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_months\'] }}</strong>		<a href="" data-ng-if="displayMode !== DISPLAY_MODE_MONTH"			data-ng-click="setView(displayValue, DISPLAY_MODE_MONTH)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_months\'] }}</a> |		<strong data-ng-if="displayMode === DISPLAY_MODE_YEAR">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_years\'] }}</strong>		<a href="" data-ng-if="displayMode !== DISPLAY_MODE_YEAR"			data-ng-click="setView(displayValue, DISPLAY_MODE_YEAR)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_years\'] }}</a>	</p>	<!-- pager -->	<ul class="pager pager-navigation" data-ng-if="showPager">		<li class="previous">			<a href="" data-ng-click="prev()"><span aria-hidden="true">&larr;</span></a>		</li>		<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_DAY">			<a href=""				data-ng-if="enableDisplayModeSwitch"				data-ng-click="setDisplayMode(DISPLAY_MODE_MONTH)">{{ displayValue | date:\'MMMM yyyy\' }}</a>			<a data-ng-if="!enableDisplayModeSwitch">{{ displayValue | date:\'MMMM yyyy\' }}</a>		</li>		<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_MONTH">			<a href=""				data-ng-if="enableDisplayModeSwitch"				data-ng-click="setDisplayMode(DISPLAY_MODE_YEAR)">{{ displayValue | date:\'yyyy\' }}</a>			<a data-ng-if="!enableDisplayModeSwitch">{{ displayValue | date:\'yyyy\' }}</a>		</li>		<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_YEAR">			<div class="pager-link">{{ getYearRange() }}</div>		</li>		<li class="next">			<a href="" data-ng-click="next()"><span aria-hidden="true">&rarr;</span></a>		</li>	</ul>	<!-- days -->	<table class="calendar calendar-day" data-ng-if="displayMode === DISPLAY_MODE_DAY">		<tr>			<td data-ng-if="showWeekNumbers">				<a class="weekday">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_week_number_short\'] }}</a>			</td>			<td data-ng-repeat="day in weekDays">				<a class="weekday">{{ day }}</a>			</td>		</tr>		<tr data-ng-repeat="week in days">			<td data-ng-if="showWeekNumbers">				<a class="week-number" data-ng-click="selectWeek(week[0])">{{ week[0] | date:\'w\' }}</a>			</td>			<td data-ng-repeat="day in week">				<a href=""					data-ng-click="select(day)"					data-ng-class="getDateClasses(day)">{{ day | date:\'d\' }}</a>			</td>		</tr>	</table>	<!-- months -->	<table class="calendar calendar-month" data-ng-if="displayMode === DISPLAY_MODE_MONTH">		<tr data-ng-repeat="row in months">			<td data-ng-repeat="month in row">				<a href=""					data-ng-click="select(month)"					data-ng-class="getDateClasses(month)">{{ month | date:\'MMM\' }}</a>			</td>		</tr>	</table>	<!-- years -->	<table class="calendar calendar-year" data-ng-if="displayMode === DISPLAY_MODE_YEAR">		<tr data-ng-repeat="row in years">			<td data-ng-repeat="year in row">				<a href=""					data-ng-click="select(year)"					data-ng-class="getDateClasses(year)">{{ year | date:\'yyyy\' }}</a>			</td>		</tr>	</table>	<!-- quick links -->	<ul class="pager pager-quick-links" data-ng-if="showSelectionButton || showTodayButton">		<li class="text-center">			<a href="" data-ng-if="showTodayButton"				data-ng-click="goToToday()">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_today\'] }}</a>			<a href="" data-ng-if="showSelectionButton"				data-ng-click="goToSelection()">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_selection\'] }}</a>		</li>	</ul></div>')});
//# sourceMappingURL=time-range-selector.min.js.map