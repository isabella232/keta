/**
 * keta 1.9.0
 * Build 2020-09-16T06:49:59.784Z
 *
 * Copyright Kiwigrid GmbH 2014-2020
 * http://kiwigrid.github.io/keta/
 *
 * Licensed under MIT License
 * https://raw.githubusercontent.com/kiwigrid/keta/master/LICENSE
 */
"use strict";angular.module("keta.directives.TimeRangeSelector",["moment"]).constant("ketaTimeRangeSelectorConstants",{CSS_CLASSES:{CURRENT_DATE:"current-date",OUT_OF_BOUNDS:"out-of-bounds",OUT_OF_BOUNDS_AFTER:"out-of-bounds-after",OUT_OF_BOUNDS_BEFORE:"out-of-bounds-before",OUT_OF_MONTH:"out-of-month",SELECTED_DATE:"selected-date",SELECTED_DATE_FROM:"selected-date-from",SELECTED_DATE_TO:"selected-date-to"},DAY:{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},DISPLAY_MODE:{DAY:"day",MONTH:"month",YEAR:"year"},EVENT:{SELECT:"keta.directives.TimeRangeSelector.Event.Selected"}}).constant("ketaTimeRangeSelectorMessageKeys",{en_GB:{"__keta.directives.TimeRangeSelector_display_mode_days":"Days","__keta.directives.TimeRangeSelector_display_mode_months":"Months","__keta.directives.TimeRangeSelector_display_mode_years":"Years","__keta.directives.TimeRangeSelector_select":"Select","__keta.directives.TimeRangeSelector_selection":"Selection","__keta.directives.TimeRangeSelector_today":"Today","__keta.directives.TimeRangeSelector_week":"Week","__keta.directives.TimeRangeSelector_weekday_sunday":"Sunday","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Sun","__keta.directives.TimeRangeSelector_weekday_monday":"Monday","__keta.directives.TimeRangeSelector_weekday_monday_short":"Mon","__keta.directives.TimeRangeSelector_weekday_tuesday":"Tuesday","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Tue","__keta.directives.TimeRangeSelector_weekday_wednesday":"Wednesday","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Wed","__keta.directives.TimeRangeSelector_weekday_thursday":"Thursday","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Thu","__keta.directives.TimeRangeSelector_weekday_friday":"Friday","__keta.directives.TimeRangeSelector_weekday_friday_short":"Fri","__keta.directives.TimeRangeSelector_weekday_saturday":"Saturday","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sat","__keta.directives.TimeRangeSelector_week_number":"Week Number","__keta.directives.TimeRangeSelector_week_number_short":"Wn"},de_DE:{"__keta.directives.TimeRangeSelector_display_mode_days":"Tage","__keta.directives.TimeRangeSelector_display_mode_months":"Monate","__keta.directives.TimeRangeSelector_display_mode_years":"Jahre","__keta.directives.TimeRangeSelector_select":"Auswählen","__keta.directives.TimeRangeSelector_selection":"Auswahl","__keta.directives.TimeRangeSelector_today":"Heute","__keta.directives.TimeRangeSelector_week":"Woche","__keta.directives.TimeRangeSelector_weekday_sunday":"Sonntag","__keta.directives.TimeRangeSelector_weekday_sunday_short":"So","__keta.directives.TimeRangeSelector_weekday_monday":"Montag","__keta.directives.TimeRangeSelector_weekday_monday_short":"Mo","__keta.directives.TimeRangeSelector_weekday_tuesday":"Dienstag","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Di","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mittwoch","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mi","__keta.directives.TimeRangeSelector_weekday_thursday":"Donnerstag","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Do","__keta.directives.TimeRangeSelector_weekday_friday":"Freitag","__keta.directives.TimeRangeSelector_weekday_friday_short":"Fr","__keta.directives.TimeRangeSelector_weekday_saturday":"Samstag","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sa","__keta.directives.TimeRangeSelector_week_number":"Kalenderwoche","__keta.directives.TimeRangeSelector_week_number_short":"KW"},fr_FR:{"__keta.directives.TimeRangeSelector_display_mode_days":"Journées","__keta.directives.TimeRangeSelector_display_mode_months":"Mois","__keta.directives.TimeRangeSelector_display_mode_years":"Années","__keta.directives.TimeRangeSelector_select":"Choisir","__keta.directives.TimeRangeSelector_selection":"Sélection","__keta.directives.TimeRangeSelector_today":"Aujourd’hui","__keta.directives.TimeRangeSelector_week":"Semaine","__keta.directives.TimeRangeSelector_weekday_sunday":"Dimanche","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Dim","__keta.directives.TimeRangeSelector_weekday_monday":"Lundi","__keta.directives.TimeRangeSelector_weekday_monday_short":"Lun","__keta.directives.TimeRangeSelector_weekday_tuesday":"Mardi","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Mar","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mercredi","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mer","__keta.directives.TimeRangeSelector_weekday_thursday":"Jeudi","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Jeu","__keta.directives.TimeRangeSelector_weekday_friday":"Vendredi","__keta.directives.TimeRangeSelector_weekday_friday_short":"Ven","__keta.directives.TimeRangeSelector_weekday_saturday":"Samedi","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sam","__keta.directives.TimeRangeSelector_week_number":"Numéro de la semaine","__keta.directives.TimeRangeSelector_week_number_short":"Sem."},nl_NL:{"__keta.directives.TimeRangeSelector_display_mode_days":"Dagen","__keta.directives.TimeRangeSelector_display_mode_months":"Maanden","__keta.directives.TimeRangeSelector_display_mode_years":"Jaren","__keta.directives.TimeRangeSelector_select":"Kiezen","__keta.directives.TimeRangeSelector_selection":"Selectie","__keta.directives.TimeRangeSelector_today":"Vandaag","__keta.directives.TimeRangeSelector_week":"Week","__keta.directives.TimeRangeSelector_weekday_sunday":"Zondag","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Zo","__keta.directives.TimeRangeSelector_weekday_monday":"Maandag","__keta.directives.TimeRangeSelector_weekday_monday_short":"Ma","__keta.directives.TimeRangeSelector_weekday_tuesday":"Dinsdag","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Di","__keta.directives.TimeRangeSelector_weekday_wednesday":"Woensdag","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Wo","__keta.directives.TimeRangeSelector_weekday_thursday":"Donderdag","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Do","__keta.directives.TimeRangeSelector_weekday_friday":"Vrijdag","__keta.directives.TimeRangeSelector_weekday_friday_short":"Vr","__keta.directives.TimeRangeSelector_weekday_saturday":"Zaterdag","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Za","__keta.directives.TimeRangeSelector_week_number":"Weeknummer","__keta.directives.TimeRangeSelector_week_number_short":"Wn"},it_IT:{"__keta.directives.TimeRangeSelector_display_mode_days":"Giorni","__keta.directives.TimeRangeSelector_display_mode_months":"Mesi","__keta.directives.TimeRangeSelector_display_mode_years":"Anni","__keta.directives.TimeRangeSelector_select":"Scegliere","__keta.directives.TimeRangeSelector_selection":"Selezione","__keta.directives.TimeRangeSelector_today":"Oggi","__keta.directives.TimeRangeSelector_week":"Settimana","__keta.directives.TimeRangeSelector_weekday_sunday":"Domenica","__keta.directives.TimeRangeSelector_weekday_sunday_short":"Dom.","__keta.directives.TimeRangeSelector_weekday_monday":"Lunedì","__keta.directives.TimeRangeSelector_weekday_monday_short":"Lun.","__keta.directives.TimeRangeSelector_weekday_tuesday":"Martedì","__keta.directives.TimeRangeSelector_weekday_tuesday_short":"Mar.","__keta.directives.TimeRangeSelector_weekday_wednesday":"Mercoledì","__keta.directives.TimeRangeSelector_weekday_wednesday_short":"Mer.","__keta.directives.TimeRangeSelector_weekday_thursday":"Giovedì","__keta.directives.TimeRangeSelector_weekday_thursday_short":"Gio.","__keta.directives.TimeRangeSelector_weekday_friday":"Venerdì","__keta.directives.TimeRangeSelector_weekday_friday_short":"Ven.","__keta.directives.TimeRangeSelector_weekday_saturday":"Sabato","__keta.directives.TimeRangeSelector_weekday_saturday_short":"Sab.","__keta.directives.TimeRangeSelector_week_number":"Numero della settimana","__keta.directives.TimeRangeSelector_week_number_short":"Set."}}).directive("ketaTimeRangeSelector",function($filter,ketaTimeRangeSelectorConstants,ketaTimeRangeSelectorMessageKeys,moment){return{restrict:"EA",replace:!0,require:"ngModel",scope:{cssClasses:"=?",currentLocale:"=?",displayMode:"=?",displayValue:"=?",elementIdentifier:"=?",enableDisplayModeSwitch:"=?",enableWeekSelection:"=?",firstClick:"=?",firstDayOfWeek:"=?",labels:"=?",maximum:"=?",maxRangeLength:"=?",minimum:"=?",minRangeLength:"=?",model:"=ngModel",showDisplayModeSwitcher:"=?",showPager:"=?",showJumpToSelectionButton:"=?",showJumpToTodayButton:"=?",showSelectButton:"=?",showWeekNumbers:"=?",yearsAfter:"=?",yearsBefore:"=?"},templateUrl:"/components/directives/time-range-selector.html",link:function(scope){scope.DISPLAY_MODE_DAY=ketaTimeRangeSelectorConstants.DISPLAY_MODE.DAY,scope.DISPLAY_MODE_MONTH=ketaTimeRangeSelectorConstants.DISPLAY_MODE.MONTH,scope.DISPLAY_MODE_YEAR=ketaTimeRangeSelectorConstants.DISPLAY_MODE.YEAR;var today=new Date;today.setHours(0,0,0,0);var defaultModel={from:null,to:null};scope.firstClick=!0,scope.model=angular.isDefined(scope.model.from)&&angular.isDate(scope.model.from)&&angular.isDefined(scope.model.to)&&angular.isDate(scope.model.to)?scope.model:defaultModel,null!==scope.model.from&&(scope.model.from.setHours(0,0,0,0),scope.firstClick=!1),null!==scope.model.to&&(scope.model.to.setHours(0,0,0,0),scope.firstClick=!0),scope.cssClasses=angular.isObject(scope.cssClasses)?angular.extend(ketaTimeRangeSelectorConstants.CSS_CLASSES,scope.cssClasses):ketaTimeRangeSelectorConstants.CSS_CLASSES,scope.currentLocale=angular.isString(scope.currentLocale)?scope.currentLocale:"en_GB",scope.displayMode=scope.displayMode||scope.DISPLAY_MODE_DAY,scope.displayValue=angular.isDate(scope.displayValue)?new Date(scope.displayValue.setHours(0,0,0,0)):angular.copy(scope.model.from),null===scope.displayValue&&(scope.displayValue=today),scope.elementIdentifier=angular.isDefined(scope.elementIdentifier)?scope.elementIdentifier:null,scope.enableDisplayModeSwitch=!!angular.isDefined(scope.enableDisplayModeSwitch)&&scope.enableDisplayModeSwitch,scope.enableWeekSelection=!angular.isDefined(scope.enableWeekSelection)||scope.enableWeekSelection,scope.firstDayOfWeek=scope.firstDayOfWeek||ketaTimeRangeSelectorConstants.DAY.SUNDAY,scope.MESSAGE_KEY_PREFIX="__keta.directives.TimeRangeSelector",scope.labels=angular.isObject(scope.labels)?angular.extend(ketaTimeRangeSelectorMessageKeys,scope.labels):ketaTimeRangeSelectorMessageKeys,scope.currentLabels=angular.isDefined(ketaTimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,5)])?ketaTimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,5)]:ketaTimeRangeSelectorMessageKeys.en_GB,scope.maximum=angular.isDate(scope.maximum)?new Date(scope.maximum.setHours(0,0,0,0)):null,scope.maxRangeLength=angular.isNumber(scope.maxRangeLength)?Math.max(0,Math.round(scope.maxRangeLength)):0,scope.minimum=angular.isDate(scope.minimum)?new Date(scope.minimum.setHours(0,0,0,0)):null,scope.minRangeLength=angular.isNumber(scope.minRangeLength)?Math.max(0,Math.round(scope.minRangeLength)):0,scope.showDisplayModeSwitcher=!angular.isDefined(scope.showDisplayModeSwitcher)||scope.showDisplayModeSwitcher,scope.showPager=!angular.isDefined(scope.showPager)||scope.showPager,scope.showJumpToSelectionButton=!!angular.isDefined(scope.showJumpToSelectionButton)&&scope.showJumpToSelectionButton,scope.showJumpToTodayButton=!!angular.isDefined(scope.showJumpToTodayButton)&&scope.showJumpToTodayButton,scope.showSelectButton=!!angular.isDefined(scope.showSelectButton)&&scope.showSelectButton,scope.showWeekNumbers=!angular.isDefined(scope.showWeekNumbers)||scope.showWeekNumbers,scope.yearsBefore=scope.yearsBefore||7,scope.yearsAfter=scope.yearsAfter||4,scope.weekDays=[],scope.days=[],scope.months=[],scope.years=[];var getWeekDays=function(){for(var weekDays=[],weekDayLabels=[scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_sunday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_monday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_tuesday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_wednesday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_thursday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_friday_short"],scope.currentLabels[scope.MESSAGE_KEY_PREFIX+"_weekday_saturday_short"]],start=scope.firstDayOfWeek;weekDays.length<7;)weekDays.push(weekDayLabels[start]),start++,start%=7;scope.weekDays=weekDays},getDays=function(){var firstOfCurrentMonth=moment(scope.displayValue.getTime()).startOf("month").hours(0).minutes(0).seconds(0).milliseconds(0),firstOfCurrentMonthWeekDay=firstOfCurrentMonth.day(),lastOfCurrentMonth=moment(firstOfCurrentMonth).add(1,"months").subtract(1,"days"),lastOfCurrentMonthWeekDay=lastOfCurrentMonth.day(),days=[],i=0;for(firstOfCurrentMonthWeekDay<scope.firstDayOfWeek&&(firstOfCurrentMonthWeekDay+=7),i=firstOfCurrentMonthWeekDay-scope.firstDayOfWeek;i>0;i--){var prependedDay=moment(firstOfCurrentMonth).subtract(i,"days");days.push(prependedDay.toDate())}var monthDays=moment(lastOfCurrentMonth).date();for(i=0;i<monthDays;i++){var monthDay=moment(firstOfCurrentMonth).add(i,"days");days.push(monthDay.toDate())}lastOfCurrentMonthWeekDay<scope.firstDayOfWeek&&(lastOfCurrentMonthWeekDay+=7);var daysToAppend=7-(lastOfCurrentMonthWeekDay-scope.firstDayOfWeek)-1;for(i=1;i<=daysToAppend;i++){var appendedDay=moment(lastOfCurrentMonth).add(i,"days");days.push(appendedDay.toDate())}var chunks=[],chunk=[];angular.forEach(days,function(day,index){chunk.push(day),(index+1)%7==0&&(chunks.push(chunk),chunk=[])}),scope.days=chunks},getMonths=function(){for(var months=[],monthsChunked=[],now=moment(scope.displayValue).date(1).hour(0).minute(0).second(0).millisecond(0).toDate(),i=0;i<12;i++)now.setMonth(i),months.push(angular.copy(now));var chunk=[];angular.forEach(months,function(month,index){chunk.push(month),(index+1)%3==0&&(monthsChunked.push(chunk),chunk=[])}),scope.months=monthsChunked},getYears=function(){var years=[],yearsChunked=[],now=moment(new Date).month(0).date(1).hour(0).minute(0).second(0).millisecond(0).toDate(),currentYear=parseInt($filter("date")(now,"yyyy"),10),yearStart=currentYear-scope.yearsBefore,yearEnd=currentYear+scope.yearsAfter,viewYear=parseInt($filter("date")(scope.displayValue,"yyyy"),10),range=scope.yearsBefore+scope.yearsAfter+1;if(viewYear<yearStart)for(;viewYear<yearStart;)yearStart-=range,yearEnd-=range;if(viewYear>yearEnd)for(;viewYear>yearEnd;)yearStart+=range,yearEnd+=range;for(var i=yearStart;i<=yearEnd;i++)now.setFullYear(i),years.push(angular.copy(now));var chunk=[];angular.forEach(years,function(year,index){chunk.push(year),(index+1)%3==0&&(yearsChunked.push(chunk),chunk=[])}),scope.years=yearsChunked},getLocaleISO=function(date,length){return(date.getFullYear()+"-"+("00"+(date.getMonth()+1)).slice(-2)+"-"+("00"+date.getDate()).slice(-2)).substr(0,length)};scope.isOutOfBounds=function(date){var outOfBounds=!1,dateISO=getLocaleISO(date,10);return null!==scope.minimum&&dateISO<getLocaleISO(scope.minimum,10)&&(outOfBounds=!0),null!==scope.maximum&&dateISO>getLocaleISO(scope.maximum,10)&&(outOfBounds=!0),outOfBounds},scope.getDateClasses=function(date){var classes=[],td=new Date((new Date).setHours(0,0,0,0)),current=scope.displayValue,isoDateLength=10,outOfBoundDates=[getLocaleISO(date,10),getLocaleISO(date,10)];scope.displayMode===scope.DISPLAY_MODE_MONTH&&(isoDateLength=7,outOfBoundDates=[getLocaleISO(moment(date).clone().startOf("month").toDate(),10),getLocaleISO(moment(date).clone().endOf("month").toDate(),10)]),scope.displayMode===scope.DISPLAY_MODE_YEAR&&(isoDateLength=4,outOfBoundDates=[getLocaleISO(moment(date).clone().startOf("year").toDate(),10),getLocaleISO(moment(date).clone().endOf("year").toDate(),10)]);var selectedDateFromISO=null!==scope.model.from?getLocaleISO(scope.model.from,isoDateLength):null,selectedDateToISO=null!==scope.model.to?getLocaleISO(scope.model.to,isoDateLength):null,dateISO=getLocaleISO(date,isoDateLength),todayISO=getLocaleISO(td,isoDateLength);if(scope.displayMode===scope.DISPLAY_MODE_DAY&&date.getMonth()!==current.getMonth()&&classes.push(scope.cssClasses.OUT_OF_MONTH),null!==scope.minimum){var minimumISO=getLocaleISO(scope.minimum,10);outOfBoundDates[0]<minimumISO&&outOfBoundDates[1]<minimumISO&&(classes.push(scope.cssClasses.OUT_OF_BOUNDS),classes.push(scope.cssClasses.OUT_OF_BOUNDS_BEFORE))}if(null!==scope.maximum){var maximumISO=getLocaleISO(scope.maximum,10);outOfBoundDates[0]>maximumISO&&outOfBoundDates[1]>maximumISO&&(classes.push(scope.cssClasses.OUT_OF_BOUNDS),classes.push(scope.cssClasses.OUT_OF_BOUNDS_AFTER))}return dateISO===todayISO&&classes.push(scope.cssClasses.CURRENT_DATE),null!==selectedDateFromISO&&null!==selectedDateToISO&&dateISO>=selectedDateFromISO&&dateISO<=selectedDateToISO&&classes.push(scope.cssClasses.SELECTED_DATE),null!==selectedDateFromISO&&dateISO===selectedDateFromISO&&classes.push(scope.cssClasses.SELECTED_DATE_FROM),null!==selectedDateToISO&&dateISO===selectedDateToISO&&classes.push(scope.cssClasses.SELECTED_DATE_TO),classes.join(" ")},scope.getYearRange=function(){var year=parseInt($filter("date")(scope.displayValue,"yyyy"),10);return year-scope.yearsBefore+" – "+(year+scope.yearsAfter)};var update=function(){scope.currentLabels=angular.isDefined(ketaTimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,5)])?ketaTimeRangeSelectorMessageKeys[scope.currentLocale.substr(0,5)]:ketaTimeRangeSelectorMessageKeys.en_GB,getWeekDays(),scope.displayMode===scope.DISPLAY_MODE_MONTH?getMonths():scope.displayMode===scope.DISPLAY_MODE_YEAR?getYears():getDays()};update();var move=function(direction){scope.displayMode===scope.DISPLAY_MODE_MONTH?scope.displayValue=moment(scope.displayValue).add(direction,"years").toDate():scope.displayMode===scope.DISPLAY_MODE_YEAR?scope.displayValue=moment(scope.displayValue).add(direction*(scope.yearsBefore+scope.yearsAfter+1),"years").toDate():scope.displayValue=moment(scope.displayValue).add(direction,"months").toDate(),update()};scope.prev=function(){move(-1)},scope.next=function(){move(1)};var getDisplayModeDate=function(date,mode,from){return mode===ketaTimeRangeSelectorConstants.DISPLAY_MODE.MONTH?from?date:moment(date).endOf("month").hour(0).minute(0).second(0).millisecond(0).toDate():mode===ketaTimeRangeSelectorConstants.DISPLAY_MODE.YEAR?from?date:moment(date).endOf("year").hour(0).minute(0).second(0).millisecond(0).toDate():angular.copy(date)},applyBoundaries=function(from,to,min,max){var range={from:from,to:to};return null!==min&&range.from<min&&(range.from=min),null!==max&&range.to>max&&(range.to=max),range},applyRangeLength=function(from,to,min,max){var range={from:from,to:to},days=moment(to).diff(moment(from),"days");return 0!==max&&days>=max&&(range.to=moment(from).add(max-1,"days").toDate()),0!==min&&days<=min&&(range.to=moment(from).add(min-1,"days").toDate()),range};scope.setDisplayMode=function(mode){mode!==scope.displayMode&&(scope.model={from:null,to:null},scope.firstClick=!0,scope.displayMode=mode,update())},scope.selectWeek=function(date){var firstOfWeek=moment(date).hour(0).minute(0).second(0).millisecond(0).toDate(),lastOfWeek=moment(firstOfWeek).add(6,"days").hour(0).minute(0).second(0).millisecond(0).toDate();!scope.isOutOfBounds(firstOfWeek)&&!scope.isOutOfBounds(lastOfWeek)&&(0===scope.minRangeLength||scope.minRangeLength<=7)&&(0===scope.maxRangeLength||scope.maxRangeLength>=7)&&scope.enableWeekSelection&&(scope.model.from=getDisplayModeDate(firstOfWeek,scope.displayMode,!0),scope.model.to=getDisplayModeDate(lastOfWeek,scope.displayMode,!1),scope.firstClick=!0)},scope.select=function(date){scope.isOutOfBounds(date)||(scope.firstClick?(scope.model.from=getDisplayModeDate(date,scope.displayMode,!0),scope.model.to=null,scope.firstClick=!1):date.getTime()<scope.model.from.getTime()?(scope.model.from=getDisplayModeDate(date,scope.displayMode,!0),scope.model.to=null,scope.firstClick=!1):(scope.model.to=getDisplayModeDate(date,scope.displayMode,!1),scope.firstClick=!0),scope.model=applyRangeLength(scope.model.from,scope.model.to,scope.minRangeLength,scope.maxRangeLength),scope.model=applyBoundaries(scope.model.from,scope.model.to,scope.minimum,scope.maximum),scope.displayValue=scope.firstClick?angular.copy(scope.model.to):angular.copy(scope.model.from))},scope.goToSelection=function(){null!==scope.model.from&&(scope.displayValue=angular.copy(scope.model.from))},scope.goToToday=function(){var td=new Date;td.setHours(0,0,0,0),scope.displayValue=td},scope.submit=function(){scope.isSelectionInvalid()||(null===scope.model.to&&(scope.model.to=getDisplayModeDate(scope.model.from,scope.displayMode,!1)),scope.$emit(ketaTimeRangeSelectorConstants.EVENT.SELECT,{id:scope.elementIdentifier,model:scope.model}))},scope.isSelectionInvalid=function(){return null===scope.model.from},scope.$watch("currentLocale",function(newValue,oldValue){newValue!==oldValue&&angular.isString(newValue)&&update()}),scope.$watch("displayMode",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("displayValue",function(newValue,oldValue){newValue!==oldValue&&angular.isDate(newValue)&&update()}),scope.$watch("firstDayOfWeek",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("maximum",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyBoundaries(scope.model.from,scope.model.to,scope.mininum,newValue))}),scope.$watch("minimum",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyBoundaries(scope.model.from,scope.model.to,newValue,scope.maximum))}),scope.$watch("maxRangeLength",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyRangeLength(scope.model.from,scope.model.to,scope.minRangeLength,newValue))}),scope.$watch("minRangeLength",function(newValue,oldValue){newValue!==oldValue&&(scope.model=applyRangeLength(scope.model.from,scope.model.to,newValue,scope.maxRangeLength))}),scope.$watch("yearsAfter",function(newValue,oldValue){newValue!==oldValue&&update()}),scope.$watch("yearsBefore",function(newValue,oldValue){newValue!==oldValue&&update()})}}}),angular.module("keta.directives.TimeRangeSelector").run(function($templateCache){$templateCache.put("/components/directives/time-range-selector.html",'<div class="keta-time-range-selector">\t\x3c!-- view mode --\x3e\t<p class="text-center display-mode-switcher" data-ng-if="showDisplayModeSwitcher">\t\t<strong data-ng-if="displayMode === DISPLAY_MODE_DAY">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_days\'] }}</strong>\t\t<a href="" data-ng-if="displayMode !== DISPLAY_MODE_DAY"\t\t\tdata-ng-click="setDisplayMode(DISPLAY_MODE_DAY)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_days\'] }}</a> |\t\t<strong data-ng-if="displayMode === DISPLAY_MODE_MONTH">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_months\'] }}</strong>\t\t<a href="" data-ng-if="displayMode !== DISPLAY_MODE_MONTH"\t\t\tdata-ng-click="setDisplayMode(DISPLAY_MODE_MONTH)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_months\'] }}</a> |\t\t<strong data-ng-if="displayMode === DISPLAY_MODE_YEAR">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_years\'] }}</strong>\t\t<a href="" data-ng-if="displayMode !== DISPLAY_MODE_YEAR"\t\t\tdata-ng-click="setDisplayMode(DISPLAY_MODE_YEAR)">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_display_mode_years\'] }}</a>\t</p>\t\x3c!-- pager --\x3e\t<ul class="pager pager-navigation" data-ng-if="showPager">\t\t<li class="previous">\t\t\t<a href="" data-ng-click="prev()"><span aria-hidden="true">&larr;</span></a>\t\t</li>\t\t<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_DAY">\t\t\t<a href=""\t\t\t\tdata-ng-if="enableDisplayModeSwitch"\t\t\t\tdata-ng-click="setDisplayMode(DISPLAY_MODE_MONTH)">{{ displayValue | date:\'MMMM yyyy\' }}</a>\t\t\t<a data-ng-if="!enableDisplayModeSwitch">{{ displayValue | date:\'MMMM yyyy\' }}</a>\t\t</li>\t\t<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_MONTH">\t\t\t<a href=""\t\t\t\tdata-ng-if="enableDisplayModeSwitch"\t\t\t\tdata-ng-click="setDisplayMode(DISPLAY_MODE_YEAR)">{{ displayValue | date:\'yyyy\' }}</a>\t\t\t<a data-ng-if="!enableDisplayModeSwitch">{{ displayValue | date:\'yyyy\' }}</a>\t\t</li>\t\t<li class="text-center" data-ng-if="displayMode === DISPLAY_MODE_YEAR">\t\t\t<div class="pager-link">{{ getYearRange() }}</div>\t\t</li>\t\t<li class="next">\t\t\t<a href="" data-ng-click="next()"><span aria-hidden="true">&rarr;</span></a>\t\t</li>\t</ul>\t\x3c!-- days --\x3e\t<table class="calendar calendar-day" data-ng-if="displayMode === DISPLAY_MODE_DAY">\t\t<tr>\t\t\t<td data-ng-if="showWeekNumbers">\t\t\t\t<a class="weekday">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_week_number_short\'] }}</a>\t\t\t</td>\t\t\t<td data-ng-repeat="day in weekDays">\t\t\t\t<a class="weekday">{{ day }}</a>\t\t\t</td>\t\t</tr>\t\t<tr data-ng-repeat="week in days">\t\t\t<td data-ng-if="showWeekNumbers">\t\t\t\t<a class="week-number" data-ng-click="selectWeek(week[0])">{{ week[0] | date:\'w\' }}</a>\t\t\t</td>\t\t\t<td data-ng-repeat="day in week">\t\t\t\t<a href=""\t\t\t\t\tdata-ng-click="select(day)"\t\t\t\t\tdata-ng-class="getDateClasses(day)">{{ day | date:\'d\' }}</a>\t\t\t</td>\t\t</tr>\t</table>\t\x3c!-- months --\x3e\t<table class="calendar calendar-month" data-ng-if="displayMode === DISPLAY_MODE_MONTH">\t\t<tr data-ng-repeat="row in months">\t\t\t<td data-ng-repeat="month in row">\t\t\t\t<a href=""\t\t\t\t\tdata-ng-click="select(month)"\t\t\t\t\tdata-ng-class="getDateClasses(month)">{{ month | date:\'MMM\' }}</a>\t\t\t</td>\t\t</tr>\t</table>\t\x3c!-- years --\x3e\t<table class="calendar calendar-year" data-ng-if="displayMode === DISPLAY_MODE_YEAR">\t\t<tr data-ng-repeat="row in years">\t\t\t<td data-ng-repeat="year in row">\t\t\t\t<a href=""\t\t\t\t\tdata-ng-click="select(year)"\t\t\t\t\tdata-ng-class="getDateClasses(year)">{{ year | date:\'yyyy\' }}</a>\t\t\t</td>\t\t</tr>\t</table>\t\x3c!-- quick links --\x3e\t<ul class="pager pager-quick-links"\t\tdata-ng-if="showJumpToSelectionButton || showJumpToTodayButton || showSelectButton">\t\t<li>\t\t\t<a href="" data-ng-if="showJumpToTodayButton"\t\t\t\tdata-ng-click="goToToday()">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_today\'] }}</a>\t\t</li>\t\t<li>\t\t\t<a href="" data-ng-if="showJumpToSelectionButton"\t\t\t\tdata-ng-click="goToSelection()">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_selection\'] }}</a>\t\t</li>\t\t<li data-ng-class="{\'disabled\': isSelectionInvalid()}">\t\t\t<a href="" data-ng-if="showSelectButton"\t\t\t\tdata-ng-click="submit()">{{ currentLabels[MESSAGE_KEY_PREFIX + \'_select\'] }}</a>\t\t</li>\t</ul></div>')});
//# sourceMappingURL=time-range-selector.min.js.map