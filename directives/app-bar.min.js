/**
 * keta 1.3.0
 * Build 2018-01-25T09:59:34.907Z
 *
 * Copyright Kiwigrid GmbH 2014-2018
 * http://kiwigrid.github.io/keta/
 *
 * Licensed under MIT License
 * https://raw.githubusercontent.com/kiwigrid/keta/master/LICENSE
 */
"use strict";angular.module("keta.directives.AppBar",["keta.directives.Sidebar","keta.services.AccessToken","keta.services.ApplicationSet","keta.services.Device","keta.services.DeviceSet","keta.services.EventBusDispatcher","keta.services.EventBusManager","keta.services.User","keta.utils.Application","keta.utils.Common"]).constant("ketaAppBarConstants",{COMPONENT:{WORLD_SWITCHER:"worldSwitcher",MENU_BAR_TOGGLE:"menuBarToggle",NOTIFICATION_BAR_TOGGLE:"notificationBarToggle",APP_TITLE:"appTitle",USER_MENU:"userMenu",LANGUAGE_MENU:"languageMenu",ENERGY_MANAGER_MENU:"energyManagerMenu",COMPACT_MENU:"compactMenu"},ROOT_APP_ID:"kiwigrid.desktop",SIZE:{XXS:"xxs",XS:"xs",SM:"sm",MD:"md",LG:"lg"},STATE:{HIDDEN:"hidden",FULL:"full",COMPACT:"compact"},TOGGLES:{USER_PROFILE:"USER_PROFILE",USER_LOGOUT:"USER_LOGOUT"},USER_ROLE:{ADMIN:"ADMIN",DEMO_USER:"DEMO_USER",FITTER:"FITTER",SERVICE:"SERVICE",SUPER_ADMIN:"SUPER_ADMIN",USER:"USER"}}).constant("ketaAppBarMessageKeys",{en_GB:{"__keta.directives.AppBar_app_title":"Application","__keta.directives.AppBar_all_apps":"All Apps","__keta.directives.AppBar_all_energy_managers":"All Energy-Managers","__keta.directives.AppBar_energy_manager":"Energy-Manager","__keta.directives.AppBar_user_logout":"Logout","__keta.directives.AppBar_user_profile":"User Account","__keta.directives.AppBar_logged_in_as":"You are temporarily logged in as","__keta.directives.AppBar_drop_access":"Drop access"},de_DE:{"__keta.directives.AppBar_app_title":"Applikation","__keta.directives.AppBar_all_apps":"Alle Apps","__keta.directives.AppBar_all_energy_managers":"Alle Energy-Manager","__keta.directives.AppBar_energy_manager":"Energy-Manager","__keta.directives.AppBar_user_logout":"Abmelden","__keta.directives.AppBar_user_profile":"Benutzerkonto","__keta.directives.AppBar_logged_in_as":"Sie sind temporär angemeldet als","__keta.directives.AppBar_drop_access":"Zugriff beenden"},fr_FR:{"__keta.directives.AppBar_app_title":"Application","__keta.directives.AppBar_all_apps":"Toutes les Applications","__keta.directives.AppBar_all_energy_managers":"Tous les Energy-Managers","__keta.directives.AppBar_energy_manager":"Energy-Manager","__keta.directives.AppBar_user_logout":"Se déconnecter","__keta.directives.AppBar_user_profile":"Compte d’utilisateur","__keta.directives.AppBar_logged_in_as":"Vous êtes connecté en tant que temporairement","__keta.directives.AppBar_drop_access":"Déposez accès"},nl_NL:{"__keta.directives.AppBar_app_title":"Applicatie","__keta.directives.AppBar_all_apps":"Alle applicaties","__keta.directives.AppBar_all_energy_managers":"Alle Energy-Managers","__keta.directives.AppBar_energy_manager":"Energy-Manager","__keta.directives.AppBar_user_logout":"Uitloggen","__keta.directives.AppBar_user_profile":"Gebruikers account","__keta.directives.AppBar_logged_in_as":"U bent tijdelijk aangemeld als","__keta.directives.AppBar_drop_access":"Drop toegang"},it_IT:{"__keta.directives.AppBar_app_title":"Application","__keta.directives.AppBar_all_apps":"Tutte le applicazioni","__keta.directives.AppBar_all_energy_managers":"Tutti gli Energy-Managers","__keta.directives.AppBar_energy_manager":"Energy-Manager","__keta.directives.AppBar_user_logout":"Disconnettersi","__keta.directives.AppBar_user_profile":"Account utente","__keta.directives.AppBar_logged_in_as":"Stai temporaneamente l’accesso come","__keta.directives.AppBar_drop_access":"Goccia accesso"}}).directive("ketaAppBar",function($rootScope,$window,$document,$filter,$log,ketaEventBusDispatcher,ketaEventBusManager,ketaDeviceSet,ketaApplicationSet,ketaUser,ketaAccessToken,ketaAccessTokenConstants,ketaAppBarConstants,ketaAppBarMessageKeys,ketaDeviceConstants,ketaSidebarConstants,ketaCommonUtils,ketaApplicationUtils){return{restrict:"EA",replace:!0,scope:{eventBusId:"=?",locales:"=?",cssClasses:"=?",currentLocale:"=?",fallbackLocale:"=?",labels:"=?",links:"=?",worlds:"=?",displayModes:"=?",rootApp:"=?",toggles:"=?"},transclude:!0,templateUrl:"/components/directives/app-bar.html",link:function(scope,element){scope.user={},scope.menus={},scope.worlds=scope.worlds||[],scope.locales=scope.locales||[],scope.cssClasses=scope.cssClasses||{},scope.energyManagers=[],scope.impersonationInfo={},scope.locales=$filter("orderBy")(scope.locales,"name"),scope.eventBusId=scope.eventBusId||"kiwibus";var eventBus=ketaEventBusManager.get(scope.eventBusId),STATES=ketaAppBarConstants.STATE,SIZES=ketaAppBarConstants.SIZE;scope.MENU_ELEMENTS=ketaAppBarConstants.COMPONENT;var sizesFullState={};sizesFullState[SIZES.XXS]=STATES.FULL,sizesFullState[SIZES.XS]=STATES.FULL,sizesFullState[SIZES.SM]=STATES.FULL,sizesFullState[SIZES.MD]=STATES.FULL,sizesFullState[SIZES.LG]=STATES.FULL;var sizesDefaultState={};sizesDefaultState[SIZES.XXS]=STATES.HIDDEN,sizesDefaultState[SIZES.XS]=STATES.HIDDEN,sizesDefaultState[SIZES.SM]=STATES.COMPACT,sizesDefaultState[SIZES.MD]=STATES.COMPACT,sizesDefaultState[SIZES.LG]=STATES.FULL;var sizesHiddenState={};sizesHiddenState[SIZES.XXS]=STATES.HIDDEN,sizesHiddenState[SIZES.XS]=STATES.HIDDEN,sizesHiddenState[SIZES.SM]=STATES.HIDDEN,sizesHiddenState[SIZES.MD]=STATES.HIDDEN,sizesHiddenState[SIZES.LG]=STATES.HIDDEN;var defaultDisplayModes={};defaultDisplayModes[scope.MENU_ELEMENTS.WORLD_SWITCHER]=sizesHiddenState,defaultDisplayModes[scope.MENU_ELEMENTS.MENU_BAR_TOGGLE]=sizesFullState,defaultDisplayModes[scope.MENU_ELEMENTS.NOTIFICATION_BAR_TOGGLE]=sizesFullState,defaultDisplayModes[scope.MENU_ELEMENTS.APP_TITLE]=sizesFullState,defaultDisplayModes[scope.MENU_ELEMENTS.USER_MENU]=sizesDefaultState,defaultDisplayModes[scope.MENU_ELEMENTS.ENERGY_MANAGER_MENU]=sizesDefaultState,defaultDisplayModes[scope.MENU_ELEMENTS.LANGUAGE_MENU]=sizesDefaultState,defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU]={},defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU][SIZES.XXS]=STATES.COMPACT,defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU][SIZES.XS]=STATES.COMPACT,defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU][SIZES.SM]=STATES.HIDDEN,defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU][SIZES.MD]=STATES.HIDDEN,defaultDisplayModes[scope.MENU_ELEMENTS.COMPACT_MENU][SIZES.LG]=STATES.HIDDEN;var scrollContainerHeight=120;scope.container=element[0];var navBars=element.find("nav"),navbarFirst=navBars[0],navbarFirstHeight=0,impersonationBar=element[0].getElementsByClassName("impersonation-bar")[0],impersonationBarHeight=0,navbarSecond=navBars[1],navbarSecondHeight=0,navbarSecondMarginBottom=0,isMenuVisible=function(menuElement){var isVisible=!1;return angular.forEach(SIZES,function(size){scope.displayModes[menuElement][size]!==STATES.HIDDEN&&(isVisible=!0)}),isVisible},setContainerHeight=function(){navbarFirstHeight=navbarFirst.offsetHeight,angular.isDefined(impersonationBar)&&(impersonationBarHeight=impersonationBar.offsetHeight),navbarSecondHeight=navbarSecond.offsetHeight,navbarSecondMarginBottom=parseInt($window.getComputedStyle(navbarSecond,null).getPropertyValue("margin-bottom"),10),scrollContainerHeight=navbarFirstHeight+impersonationBarHeight+navbarSecondHeight+navbarSecondMarginBottom},isLocaleAvailable=function(localeCode){var isAvailable=!1;return angular.forEach(scope.locales,function(availableLocale){angular.isDefined(availableLocale.code)&&availableLocale.code===localeCode&&(isAvailable=!0)}),isAvailable};scope.displayModes=function mergeObjects(customObject,defaultObject){var value,result={};for(value in customObject)value in defaultObject&&"object"==typeof customObject[value]&&null!==value?result[value]=mergeObjects(customObject[value],defaultObject[value]):result[value]=customObject[value];for(value in defaultObject)value in result||(result[value]=defaultObject[value]);return result}(scope.displayModes,defaultDisplayModes),scope.fallbackLocale=scope.fallbackLocale||"en_GB",scope.currentLocale=scope.currentLocale||scope.fallbackLocale,isLocaleAvailable(scope.currentLocale)||(scope.currentLocale=scope.fallbackLocale),scope.MESSAGE_KEY_PREFIX="__keta.directives.AppBar",scope.labels=angular.extend(ketaAppBarMessageKeys,scope.labels),scope.getLabel=function(key){return ketaCommonUtils.getLabelByLocale(key,scope.labels,scope.currentLocale)};var accessToken=ketaAccessToken.decode(ketaAccessToken.get()),defaultLinks={ALL_APPS:null,ALL_ENERGY_MANAGERS:null,APP_ROOT:null!==accessToken&&angular.isDefined(accessToken.user_id)?ketaCommonUtils.addUrlParameter("/","userId",accessToken.user_id):"/",USER_PROFILE:null,USER_LOGOUT:null};scope.TYPES={ENERGY_MANAGER:"ENERGY_MANAGER"},scope.LIMITS={ENERGY_MANAGER:3};var PREDICATES={ENERGY_MANAGER:{field:"name",reverse:!1}};scope.links=angular.isDefined(scope.links)?angular.extend(defaultLinks,scope.links):defaultLinks;var defaultToggles={};defaultToggles[ketaAppBarConstants.USER_ROLE.DEMO_USER]={},defaultToggles[ketaAppBarConstants.USER_ROLE.DEMO_USER][ketaAppBarConstants.TOGGLES.USER_PROFILE]=!1,scope.AVAILABLE_TOGGLES=ketaAppBarConstants.TOGGLES;var updateToggles=function(){if(angular.isDefined(scope.toggles)){var toggles=angular.copy(defaultToggles);angular.forEach(scope.toggles,function(userRoleToggles,userRole){angular.equals(scope.toggles[userRole],{})||(toggles[userRole]=angular.extend(toggles[userRole]||{},scope.toggles[userRole]))}),scope.toggles=toggles}else scope.toggles=angular.copy(defaultToggles)};updateToggles();var allLinkKeysAlreadySet=!0;angular.forEach(Object.keys(defaultLinks),function(linkKey){null===defaultLinks[linkKey]&&(allLinkKeysAlreadySet=!1)}),!1===allLinkKeysAlreadySet&&(scope.links.USER_LOGOUT=angular.isString(scope.links.USER_LOGOUT)?scope.links.USER_LOGOUT:"/rest/auth/logout",ketaApplicationUtils.getAppList({eventBusId:scope.eventBusId,filter:{appId:ketaAppBarConstants.ROOT_APP_ID}}).then(function(apps){var entryUri=null,name={};if(scope.rootApp=null,angular.forEach(apps,function(app){angular.isDefined(app.appId)&&app.appId===ketaAppBarConstants.ROOT_APP_ID&&angular.isDefined(app.entryUri)&&(entryUri=app.entryUri,ketaCommonUtils.doesPropertyExist(app,"meta.i18n")&&angular.forEach(Object.keys(app.meta.i18n),function(locale){angular.forEach(scope.locales,function(availableLocale){angular.isDefined(availableLocale.code)&&availableLocale.code===locale&&(name[availableLocale.code]=app.meta.i18n[locale].name)})}))}),document.createElement("a").href=entryUri,null!==entryUri&&(scope.rootApp={},scope.rootApp.link=ketaCommonUtils.addUrlParameter(entryUri,"userId",accessToken.user_id),scope.rootApp.name=name,scope.worlds.unshift({name:"Desktop",link:scope.rootApp.link})),scope.links.ALL_APPS=angular.isString(scope.links.ALL_APPS)?scope.links.ALL_APPS:ketaCommonUtils.addUrlParameter(entryUri+"#/applications","userId",accessToken.user_id),scope.links.USER_PROFILE=angular.isString(scope.links.USER_PROFILE)?scope.links.USER_PROFILE:ketaCommonUtils.addUrlParameter(entryUri+"#/user","userId",accessToken.user_id),!angular.isString(scope.links.ALL_ENERGY_MANAGERS)){var allManagersUri=ketaCommonUtils.addUrlParameter(entryUri,"deviceClass","com.kiwigrid.devices.em.EnergyManager");scope.links.ALL_ENERGY_MANAGERS=ketaCommonUtils.addUrlParameter(allManagersUri+"#/devices","userId",accessToken.user_id)}})),scope.getClasses=function(menuName,elementType){var classes=[];return angular.isDefined(elementType)||(elementType="menu"),angular.isDefined(scope.menus[menuName])&&angular.isDefined(scope.menus[menuName].isOpen)&&scope.menus[menuName].isOpen&&classes.push("open"),angular.forEach(SIZES,function(size){var state=scope.displayModes[menuName][size];switch(elementType){case"menu":switch(state){case STATES.HIDDEN:classes.push("hidden-"+size);break;case STATES.FULL:case STATES.COMPACT:classes.push("visible-"+size)}break;case"label":state===STATES.COMPACT&&classes.push("hidden-"+size)}}),angular.isString(scope.cssClasses[menuName])&&classes.push(scope.cssClasses[menuName]),classes.join(" ")};var getDevices=function(){null!==eventBus&&angular.isDefined(scope.user.userId)&&isMenuVisible(scope.MENU_ELEMENTS.ENERGY_MANAGER_MENU)&&ketaDeviceSet.create(eventBus).filter({"deviceModel.deviceClass":{$in:[ketaDeviceConstants.CLASS.ENERGY_MANAGER]},owner:scope.user.userId}).project({tagValues:{IdName:1,SettingsNetworkMap:1}}).query().then(function(reply){if(angular.isDefined(reply.result)&&angular.isDefined(reply.result.items)){var energyManagers=[];angular.forEach(reply.result.items,function(item){var emIP=angular.isDefined(item.tagValues)&&angular.isDefined(item.tagValues.SettingsNetworkMap)&&angular.isDefined(item.tagValues.SettingsNetworkMap.value)&&angular.isDefined(item.tagValues.SettingsNetworkMap.value.ipv4)?item.tagValues.SettingsNetworkMap.value.ipv4:null;null!==emIP&&energyManagers.push({name:item.tagValues.IdName.value,link:"http://"+emIP})}),scope.energyManagers=energyManagers}})},getActiveLangEntry=function(){var activeLangEntry=scope.locales[0]||{};return angular.forEach(scope.locales,function(value){value.code===scope.currentLocale&&(activeLangEntry=value)}),activeLangEntry},readLocaleFromUserProp=function(){ketaCommonUtils.doesPropertyExist(scope.user,"properties.locale.code")&&isLocaleAvailable(scope.user.properties.locale.code)&&(scope.currentLocale=scope.user.properties.locale.code)},writeLocaleUserProp=function(localeCode){scope.user.properties=scope.user.properties||{},scope.user.properties.locale=scope.user.properties.locale||{},scope.user.properties.locale.code=localeCode;var params={userId:scope.user.userId},body={properties:scope.user.properties};ketaEventBusDispatcher.send(eventBus,"userservice",{action:"mergeUser",body:body,params:params},function(reply){ketaEventBusManager.inDebugMode()&&$log.request(["userservice",{action:"mergeUser",params:params,body:body},reply],$log.ADVANCED_FORMATTER)})},updateMenus=function(){scope.menus={},scope.menus[scope.MENU_ELEMENTS.COMPACT_MENU]={isOpen:!1},scope.menus[scope.MENU_ELEMENTS.WORLD_SWITCHER]={isOpen:!1},scope.menus[scope.MENU_ELEMENTS.ENERGY_MANAGER_MENU]={isOpen:!1},scope.menus[scope.MENU_ELEMENTS.USER_MENU]={isOpen:!1},scope.menus[scope.MENU_ELEMENTS.LANGUAGE_MENU]={isOpen:!1,activeEntry:getActiveLangEntry()}};null!==eventBus&&ketaUser.getCurrent(eventBus).then(function(reply){scope.user=reply,readLocaleFromUserProp(),getDevices()}),scope.isImpersonated=function(){var result=!1;return ketaAccessToken.isType(ketaAccessTokenConstants.SESSION_TYPE.IMPERSONATED)&&(scope.impersonationInfo={userId:ketaAccessToken.getUserId(),backUrl:ketaAccessToken.getBackUrl()},result=!0),result},scope.isEnabled=function(toggle){var enabled=!0,userRoleScores={};userRoleScores[ketaAppBarConstants.USER_ROLE.DEMO_USER]=1,userRoleScores[ketaAppBarConstants.USER_ROLE.USER]=2,userRoleScores[ketaAppBarConstants.USER_ROLE.FITTER]=3,userRoleScores[ketaAppBarConstants.USER_ROLE.SERVICE]=4,userRoleScores[ketaAppBarConstants.USER_ROLE.ADMIN]=5,userRoleScores[ketaAppBarConstants.USER_ROLE.SUPER_ADMIN]=6;var userRole=ketaAppBarConstants.USER_ROLE.DEMO_USER;return angular.isDefined(scope.user)&&angular.isDefined(scope.user.roles)&&scope.user.roles.forEach(function(role){userRoleScores[userRole]<userRoleScores[role]&&(userRole=role)}),angular.isDefined(scope.toggles[userRole])&&angular.isDefined(scope.toggles[userRole][toggle])&&(enabled=scope.toggles[userRole][toggle]),enabled},scope.order=function(type){var field=angular.isDefined(PREDICATES[type])?PREDICATES[type].field:"name";return function(item){return angular.isDefined(item[field])?item[field]:""}},scope.reverse=function(type){return!(!angular.isDefined(PREDICATES[type])||!angular.isDefined(PREDICATES[type].reverse))&&PREDICATES[type].reverse},scope.scrollOverNavbarFirst=!1,angular.element($window).bind("scroll",function(){angular.isDefined(navbarFirst)&&(this.scrollY>navbarFirstHeight+impersonationBarHeight?(scope.scrollOverNavbarFirst=!0,element.css("height",scrollContainerHeight+"px")):(scope.scrollOverNavbarFirst=!1,element.css("height","auto")),scope.menus.worldSwitcher.isOpen=!1,scope.$digest())}),scope.toggleOpenState=function(menuName){if(angular.isDefined(scope.menus[menuName])){var currentState=angular.copy(scope.menus[menuName].isOpen);scope.closeAllMenus(),currentState===scope.menus[menuName].isOpen&&(scope.menus[menuName].isOpen=!scope.menus[menuName].isOpen)}},scope.closeAllMenus=function(){scope.menus[scope.MENU_ELEMENTS.WORLD_SWITCHER].isOpen=!1,scope.menus[scope.MENU_ELEMENTS.USER_MENU].isOpen=!1,scope.menus[scope.MENU_ELEMENTS.ENERGY_MANAGER_MENU].isOpen=!1,scope.menus[scope.MENU_ELEMENTS.COMPACT_MENU].isOpen=!1,scope.menus[scope.MENU_ELEMENTS.LANGUAGE_MENU].isOpen=!1},scope.setLocale=function(locale){scope.currentLocale=locale.code,writeLocaleUserProp(locale.code),scope.menus[scope.MENU_ELEMENTS.LANGUAGE_MENU].activeEntry=locale,scope.closeAllMenus()},scope.$on("$locationChangeStart",function(){scope.closeAllMenus()}),scope.isActive=function(menuName,entry){return angular.isDefined(scope.menus[menuName])&&scope.menus[menuName].activeEntry===entry},scope.toggleSidebar=function($event,position){$event.stopPropagation(),scope.closeAllMenus(),position===ketaSidebarConstants.POSITION.LEFT?$rootScope.$broadcast(ketaSidebarConstants.EVENT.TOGGLE_SIDEBAR_LEFT):position===ketaSidebarConstants.POSITION.RIGHT&&$rootScope.$broadcast(ketaSidebarConstants.EVENT.TOGGLE_SIDEBAR_RIGHT)},$document.bind("click",function(event){var appBarHtml=element.html(),targetElementHtml=angular.element(event.target).html();-1===appBarHtml.indexOf(targetElementHtml)&&(scope.closeAllMenus(),scope.$digest())}),scope.$watch("energyManagers",function(newValue,oldValue){newValue!==oldValue&&updateMenus()}),scope.$watch("currentLocale",function(newValue,oldValue){newValue!==oldValue&&updateMenus()}),scope.$watch("toggles",function(newValue,oldValue){angular.equals(newValue,oldValue)||updateToggles()}),scope.$watch("container.offsetHeight",function(newValue,oldValue){newValue!==oldValue&&setContainerHeight()}),setContainerHeight(),updateMenus()}}}),angular.module("keta.directives.AppBar").run(function($templateCache){$templateCache.put("/components/directives/app-bar.html",'<div class="navigation-container">\t<div class="impersonation-bar" data-ng-show="isImpersonated()">\t\t<div class="container-fluid">\t\t\t<span class="glyphicon glyphicon-warning-sign"></span>\t\t\t<span>\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_logged_in_as\') }}\t\t\t\t<strong>{{ user.givenName }} {{ user.familyName }} ({{impersonationInfo.userId}}). </strong>\t\t\t\t<a\t\t\t\t\ttarget="_self"\t\t\t\t\thref="{{impersonationInfo.backUrl}}"\t\t\t\t\ttitle="{{ getLabel(MESSAGE_KEY_PREFIX + \'_drop_access\') }}">\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_drop_access\') }}\t\t\t\t</a>\t\t\t</span>\t\t</div>\t</div>\t<nav class="navbar navbar-level-1 brand-bar keta-app-bar-first-row" role="navigation">\t\t<div class="container-fluid">\t\t\t<div data-ng-transclude></div>\t\t\t<div class="dropdown pull-right"\t\t\t\tdata-ng-if="worlds.length > 0"\t\t\t\tdata-ng-class="getClasses(MENU_ELEMENTS.WORLD_SWITCHER)">\t\t\t\t<a href="" class="dropdown-toggle" data-ng-click="toggleOpenState(MENU_ELEMENTS.WORLD_SWITCHER)">\t\t\t\t\t<span class="glyphicon glyphicon-th"></span>\t\t\t\t</a>\t\t\t\t<ul class="dropdown-menu">\t\t\t\t\t<li data-ng-repeat="world in worlds">\t\t\t\t\t\t<a data-ng-href="{{ world.link }}">{{ world.name }}</a>\t\t\t\t\t</li>\t\t\t\t</ul>\t\t\t</div>\t\t</div>\t</nav>\t<nav class="navbar navbar-default navbar-level-2 keta-app-bar-second-row"\t\tdata-ng-class="{\'navbar-fixed-top\': scrollOverNavbarFirst}"\t\trole="navigation">\t\t<div class="container-fluid">\t\t\t<ul class="nav navbar-nav keta-app-bar-toggle">\t\t\t\t<li class="menu-navbar" data-ng-class="getClasses(MENU_ELEMENTS.MENU_BAR_TOGGLE)">\t\t\t\t\t<a href="" data-ng-click="toggleSidebar($event, \'left\')">\t\t\t\t\t\t<span class="glyphicon glyphicon-align-justify"></span>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li data-ng-class="getClasses(MENU_ELEMENTS.APP_TITLE)">\t\t\t\t\t<a data-ng-if="links.APP_ROOT !== null" class="application-title"\t\t\t\t\t\tdata-ng-href="{{ links.APP_ROOT }}">{{ getLabel(MESSAGE_KEY_PREFIX + \'_app_title\') }}</a>\t\t\t\t\t<span data-ng-if="links.APP_ROOT === null" class="application-title">\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_app_title\') }}\t\t\t\t\t</span>\t\t\t\t</li>\t\t\t</ul>\t\t\t<ul class="nav navbar-nav navbar-right">\t\t\t\t<li class="dropdown keta-app-bar-user-menu" data-ng-class="getClasses(MENU_ELEMENTS.USER_MENU)">\t\t\t\t\t<a href="" data-ng-click="toggleOpenState(MENU_ELEMENTS.USER_MENU)">\t\t\t\t\t\t<span class="glyphicon glyphicon-user"></span>\t\t\t\t\t\t<span class="navbar-label" data-ng-class="getClasses(MENU_ELEMENTS.USER_MENU, \'label\')">\t\t\t\t\t\t\t{{ user.givenName }} {{ user.familyName }}\t\t\t\t\t\t</span>\t\t\t\t\t\t<span class="caret"></span>\t\t\t\t\t</a>\t\t\t\t\t<ul class="dropdown-menu dropdown-menu-right">\t\t\t\t\t\t<li data-ng-if="isEnabled(AVAILABLE_TOGGLES.USER_PROFILE) && links.USER_PROFILE">\t\t\t\t\t\t\t<a data-ng-href="{{ links.USER_PROFILE }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_user_profile\') }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li data-ng-if="isEnabled(AVAILABLE_TOGGLES.USER_LOGOUT)">\t\t\t\t\t\t\t<a data-ng-href="{{ links.USER_LOGOUT }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_user_logout\') }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</li>\t\t\t\t<li class="dropdown keta-app-bar-em-menu"\t\t\t\t\tdata-ng-if="energyManagers.length > 0"\t\t\t\t\tdata-ng-class="getClasses(MENU_ELEMENTS.ENERGY_MANAGER_MENU)">\t\t\t\t\t<a href="" class="dropdown-toggle"\t\t\t\t\t\tdata-ng-click="toggleOpenState(MENU_ELEMENTS.ENERGY_MANAGER_MENU)">\t\t\t\t\t\t<span class="glyphicon glyphicon-tasks" title="Energy-Manager"></span>\t\t\t\t\t\t<span class="navbar-label"\t\t\t\t\t\t\tdata-ng-class="getClasses(MENU_ELEMENTS.ENERGY_MANAGER_MENU, \'label\')">\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_energy_manager\') }}\t\t\t\t\t\t</span>\t\t\t\t\t\t<span>({{ energyManagers.length }})</span>\t\t\t\t\t\t<span class="caret"></span>\t\t\t\t\t</a>\t\t\t\t\t<ul class="dropdown-menu">\t\t\t\t\t\t<li data-ng-repeat="\t\t\t\t\t\t\tentry in energyManagers |\t\t\t\t\t\t\torderBy:order(TYPES.ENERGY_MANAGER):reverse(TYPES.ENERGY_MANAGER) |\t\t\t\t\t\t\tlimitTo:LIMITS.ENERGY_MANAGER">\t\t\t\t\t\t\t<a data-ng-href="{{ entry.link }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ entry.name }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li data-ng-if="energyManagers.length > LIMITS.ENERGY_MANAGER &&\t\t\t\t\t\t\tlinks.ALL_ENERGY_MANAGERS !== null &&\t\t\t\t\t\t\tlabels.ALL_ENERGY_MANAGERS !== null">\t\t\t\t\t\t\t<a data-ng-href="{{ links.ALL_ENERGY_MANAGERS }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_all_energy_managers\') }}\t\t\t\t\t\t\t\t({{ energyManagers.length }})\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</li>\t\t\t\t<li class="dropdown keta-app-bar-lang-menu"\t\t\t\t\tdata-ng-if="locales.length > 0"\t\t\t\t\tdata-ng-class="getClasses(MENU_ELEMENTS.LANGUAGE_MENU)">\t\t\t\t\t<a href="" class="dropdown-toggle" data-ng-click="toggleOpenState(MENU_ELEMENTS.LANGUAGE_MENU)">\t\t\t\t\t\t<span class="glyphicon glyphicon-flag"\t\t\t\t\t\t\ttitle="{{ menus.languageMenu.activeEntry.nameShort }}"></span>\t\t\t\t\t\t<span class="navbar-label" data-ng-class="getClasses(MENU_ELEMENTS.LANGUAGE_MENU, \'label\')">\t\t\t\t\t\t\t{{ menus.languageMenu.activeEntry.nameShort }}\t\t\t\t\t\t</span>\t\t\t\t\t\t<span class="caret"></span>\t\t\t\t\t</a>\t\t\t\t\t<ul class="dropdown-menu">\t\t\t\t\t\t<li data-ng-repeat="locale in locales"\t\t\t\t\t\t\tdata-ng-class="{ active: isActive(MENU_ELEMENTS.LANGUAGE_MENU, locale) }">\t\t\t\t\t\t\t<a href="" data-ng-click="setLocale(locale)">{{ locale.name }}</a>\t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</li>\t\t\t\t<li class="dropdown keta-app-bar-compact-menu" data-ng-class="getClasses(MENU_ELEMENTS.COMPACT_MENU)">\t\t\t\t\t<a href="" data-ng-click="toggleOpenState(MENU_ELEMENTS.COMPACT_MENU)">\t\t\t\t\t\t<span class="glyphicon glyphicon-option-vertical"></span>\t\t\t\t\t</a>\t\t\t\t\t<ul class="dropdown-menu dropdown-menu-right">\t\t\t\t\t\t<li>\t\t\t\t\t\t\t<a data-ng-href="{{ links.USER_PROFILE }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_user_profile\') }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li>\t\t\t\t\t\t\t<a data-ng-href="{{ links.USER_LOGOUT }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_user_logout\') }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li class="divider" data-ng-if="energyManagers.length"></li>\t\t\t\t\t\t<li data-ng-repeat="\t\t\t\t\t\t\tentry in energyManagers |\t\t\t\t\t\t\torderBy:order(TYPES.ENERGY_MANAGER):reverse(TYPES.ENERGY_MANAGER) |\t\t\t\t\t\t\tlimitTo:LIMITS.ENERGY_MANAGER">\t\t\t\t\t\t\t<a data-ng-href="{{ entry.link }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ entry.name }}\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li data-ng-if="energyManagers.length > LIMITS.ENERGY_MANAGER">\t\t\t\t\t\t\t<a data-ng-href="{{ links.ALL_ENERGY_MANAGERS }}" data-ng-click="closeAllMenus()">\t\t\t\t\t\t\t\t{{ getLabel(MESSAGE_KEY_PREFIX + \'_all_energy_managers\') }}\t\t\t\t\t\t\t\t({{ energyManagers.length }})\t\t\t\t\t\t\t</a>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li class="divider" data-ng-if="locales"></li>\t\t\t\t\t\t<li data-ng-repeat="entry in locales"\t\t\t\t\t\t\tdata-ng-class="{ active: isActive(MENU_ELEMENTS.LANGUAGE_MENU, entry) }">\t\t\t\t\t\t\t<a href="" data-ng-click="setLocale(entry)">{{ entry.name }}</a>\t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</li>\t\t\t\t<li class="keta-app-bar-notification-menu"\t\t\t\t\tdata-ng-class="getClasses(MENU_ELEMENTS.NOTIFICATION_BAR_TOGGLE)">\t\t\t\t\t<a href="" id="toggleSidebarButton" data-ng-click="toggleSidebar($event, \'right\')">\t\t\t\t\t\t<span class="glyphicon glyphicon-bell"\t\t\t\t\t\t\ttitle="{{ getLabel(MESSAGE_KEY_PREFIX + \'_notifications\') }}"></span>\t\t\t\t\t\t<span data-ng-if="notifications.length > 0" class="badge">{{notifications.length}}</span>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t</ul>\t\t</div>\t</nav>\t<div class="nav-backdrop"></div></div>')});
//# sourceMappingURL=app-bar.min.js.map